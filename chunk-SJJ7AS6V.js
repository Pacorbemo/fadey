import{a as U}from"./chunk-YUYFXWSA.js";import{a as P}from"./chunk-Z2OSFF7B.js";import{a as A,d as N}from"./chunk-NTR4IU7O.js";import{b as j}from"./chunk-6PM5SZDC.js";import{b as W,c as G,f as R,h as H,m as L,q}from"./chunk-YEOPWMZ4.js";import{$a as w,Ab as I,Bb as B,Cb as F,Da as k,Ga as a,Gb as $,Hb as D,Ka as g,Pa as h,Sa as S,Ua as p,a as O,b as y,bb as T,cb as l,fa as m,fb as V,ga as f,gb as z,ha as M,hb as i,ib as r,jb as _,lb as b,mb as C,nb as d,ob as E,vb as c,wb as v,xb as x}from"./chunk-BA2Q6BYO.js";var K=(()=>{class e{transform(t,n="uploads"){return t?/^https?:\/\//.test(t)||t.startsWith("assets/")?t:`${A.serverUrl}/${n}/${t}`:""}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275pipe=S({name:"uploads",type:e,pure:!0})}}return e})();function Y(e,s){e&1&&(M(),i(0,"svg",3),_(1,"polyline",8),r())}function Z(e,s){e&1&&(M(),i(0,"svg",4),_(1,"circle",9)(2,"path",10),r())}function tt(e,s){e&1&&c(0," \u26A0 ")}function et(e,s){if(e&1&&(i(0,"div",6),c(1),r()),e&2){let t=d(2);a(),v(t.sugerencia)}}function nt(e,s){if(e&1){let t=b();i(0,"div",7)(1,"button",11),C("click",function(){m(t);let o=d(2);return f(o.confirmar())}),c(2,"Confirmar"),r(),i(3,"button",12),C("click",function(){m(t);let o=d(2);return f(o.cancelar())}),c(4,"Cancelar"),r()()}}function ot(e,s){if(e&1&&(i(0,"div")(1,"div",1)(2,"span",2),p(3,Y,2,0,":svg:svg",3)(4,Z,3,0,":svg:svg",4)(5,tt,1,0),r(),i(6,"span",5),c(7),p(8,et,2,1,"div",6),r()(),p(9,nt,5,0,"div",7),r()),e&2){let t=d();T("toast show toast-",t.tipo,""),a(3),l(t.tipo==="exito"?3:t.tipo==="pregunta"?4:5),a(4),x(" ",t.mensaje," "),a(),l(t.sugerencia?8:-1),a(),l(t.tipo==="pregunta"?9:-1)}}var Q=(()=>{class e{constructor(t){this.toastService=t,this.mensaje="",this.sugerencia="",this.visible=!1,this.tipo="error"}ngOnInit(){this.sub=this.toastService.mensaje$.subscribe(t=>{typeof t=="object"&&t!==null?(this.mensaje=t.mensaje||"",this.sugerencia=t.sugerencia||"",this.tipo=t.tipo||"error",this.onConfirmar=t.onConfirmar,this.onCancelar=t.onCancelar):(this.mensaje=t||"",this.sugerencia="",this.tipo="error",this.onConfirmar=void 0,this.onCancelar=void 0),this.visible=!!this.mensaje})}confirmar(){this.onConfirmar&&this.onConfirmar(),this.visible=!1}cancelar(){this.onCancelar&&this.onCancelar(),this.visible=!1}ngOnDestroy(){this.sub?.unsubscribe()}static{this.\u0275fac=function(n){return new(n||e)(g(P))}}static{this.\u0275cmp=h({type:e,selectors:[["app-toast"]],decls:1,vars:1,consts:[[3,"class"],[1,"row"],[1,"toast-icon"],["width","22","height","22","viewBox","0 0 24 24","fill","none","stroke","#4caf50","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["width","22","height","22","viewBox","0 0 24 24","fill","none","stroke","#ffb300","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"toast-text"],[1,"toast-hint"],[1,"toast-actions"],["points","20 6 9 17 4 12"],["cx","12","cy","12","r","10"],["d","M12 16v-1m0-4a2 2 0 1 1 4 0c0 1.5-2 2-2 4"],[1,"btn-toast","btn-confirmar",3,"click"],[1,"btn-toast","btn-cancelar",3,"click"]],template:function(n,o){n&1&&p(0,ot,10,7,"div",0),n&2&&l(o.visible&&o.mensaje?0:-1)},styles:[".toast[_ngcontent-%COMP%]{position:fixed;top:2.5rem;left:50%;transform:translate(-50%);background:#23243a;color:#fff;padding:1rem 2.2rem 1rem 1.2rem;border-radius:.7rem;box-shadow:0 2px 16px #4c3fff2e;font-size:1.08em;font-weight:500;z-index:9999;display:flex;flex-direction:column;align-items:center;opacity:0;pointer-events:none;transition:opacity .4s,top .4s}.toast.show[_ngcontent-%COMP%]{opacity:1;pointer-events:auto;top:2.5rem}.row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1vw}.toast-icon[_ngcontent-%COMP%]{color:#ff4d6d;font-size:1.5em;margin-right:.5em}.toast-text[_ngcontent-%COMP%]{display:flex;flex-direction:column}.toast-hint[_ngcontent-%COMP%]{color:#bfc4d1;font-size:.98em;margin-top:.4em;font-weight:400;text-shadow:none;letter-spacing:.01em}.toast-exito[_ngcontent-%COMP%]{background:#eaffea;color:#222;border-left:6px solid #4caf50}.toast-exito[_ngcontent-%COMP%]   .toast-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:middle}.toast-error[_ngcontent-%COMP%]{background:#23243a;color:#fff;border-left:6px solid #ff4d6d}.toast-pregunta[_ngcontent-%COMP%]{background:#fffbe6;color:#222;border-left:6px solid #ffb300}.toast-pregunta[_ngcontent-%COMP%]   .toast-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{vertical-align:middle}.toast-actions[_ngcontent-%COMP%]{display:flex;gap:.5em;margin-top:.7em}.btn-toast[_ngcontent-%COMP%]{padding:.3em 1.1em;border:none;border-radius:4px;font-size:1em;cursor:pointer;font-weight:500;transition:background .2s}.btn-confirmar[_ngcontent-%COMP%]{background:#4caf50;color:#fff}.btn-confirmar[_ngcontent-%COMP%]:hover{background:#388e3c}.btn-cancelar[_ngcontent-%COMP%]{background:#ff5757;color:#fff}.btn-cancelar[_ngcontent-%COMP%]:hover{background:#fd2d2d}@media (max-width: 600px){.toast[_ngcontent-%COMP%]{width:90%;padding:1rem;font-size:.95em}.toast-icon[_ngcontent-%COMP%]{font-size:1.3em}}"]})}}return e})();var it=(e,s)=>s.id;function rt(e,s){if(e&1){let t=b();i(0,"div",1),_(1,"img",2),$(2,"uploads"),i(3,"div",3)(4,"h2"),c(5),r(),i(6,"p"),c(7),r(),i(8,"p"),c(9),r(),i(10,"p"),c(11),r()(),i(12,"div",4)(13,"input",5),F("ngModelChange",function(o){let u=m(t).$implicit;return B(u.reservaCantidad,o)||(u.reservaCantidad=o),f(o)}),C("blur",function(){let o=m(t).$implicit;return f(o.reservaCantidad=o.reservaCantidad<1?1:o.reservaCantidad)}),r(),i(14,"button",6),C("click",function(){let o=m(t).$implicit,u=d(2);return f(u.reservarProducto(o))}),c(15,"Reservar"),r()()()}if(e&2){let t=s.$implicit;a(),E("alt",t.nombre),w("src",D(2,8,t.foto),k),a(4),v(t.nombre),a(2),v(t.descripcion),a(2),x("Precio: ",t.precio,"\u20AC"),a(2),x("Stock: ",t.stock,""),a(2),I("ngModel",t.reservaCantidad),a(),w("disabled",t.stock<1)}}function at(e,s){if(e&1&&(i(0,"h2"),c(1),r()),e&2){let t=d(2);a(),x("",t.usernameBarbero," no tiene productos disponibles")}}function ct(e,s){if(e&1&&(i(0,"div",0),_(1,"app-toast"),V(2,rt,16,10,"div",1,it),p(4,at,2,1,"h2"),r()),e&2){let t=d();a(2),z(t.productos),a(2),l(t.productos.length==0?4:-1)}}var xt=(()=>{class e{constructor(t,n,o,u){this.route=t,this.httpService=n,this.toastService=o,this.cargandoService=u,this.usernameBarbero="",this.productos=[]}ngOnInit(){this.route.params.subscribe({next:t=>{this.usernameBarbero=t.username,this.httpService.getToken("/productos/barbero/"+this.usernameBarbero).subscribe({next:n=>{this.productos=n.map(o=>y(O({},o),{reservaCantidad:1})),this.cargandoService.cargando=!1}})}})}reservarProducto(t){t.reservaCantidad>0?this.httpService.postToken("/productos/reservar",{idProducto:t.id,cantidad:t.reservaCantidad}).subscribe({next:n=>{this.toastService.mostrar(n),t.stock-=t.reservaCantidad,t.reservaCantidad=1},error:n=>{this.toastService.error(n)}}):this.toastService.error("No se ha seleccionado ninguna cantidad para reservar.")}static{this.\u0275fac=function(n){return new(n||e)(g(j),g(N),g(P),g(U))}}static{this.\u0275cmp=h({type:e,selectors:[["app-productos"]],decls:1,vars:1,consts:[[1,"productos-container"],[1,"producto-card"],[3,"src","alt"],[1,"producto-info"],[1,"reserva"],["type","number","min","1","placeholder","Cantidad",3,"ngModelChange","blur","ngModel"],[3,"click","disabled"]],template:function(n,o){n&1&&p(0,ct,5,1,"div",0),n&2&&l(o.cargandoService.cargando?-1:0)},dependencies:[q,W,H,G,L,R,K,Q],styles:[".productos-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:60px;justify-content:center;padding:20px}.producto-card[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:8px;width:300px;box-shadow:0 2px 5px #0000001a;overflow:hidden;display:flex;flex-direction:column;background-color:var(--surface-alt, #23231f);--color: rgba(197, 197, 197, .123);background-image:linear-gradient(0deg,transparent 24%,var(--color) 25%,var(--color) 26%,transparent 27%,transparent 74%,var(--color) 75%,var(--color) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,var(--color) 25%,var(--color) 26%,transparent 27%,transparent 74%,var(--color) 75%,var(--color) 76%,transparent 77%,transparent);background-size:55px 55px}.producto-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{margin-top:1.4rem;border-radius:10px;width:100%;height:200px;object-fit:contain}.producto-info[_ngcontent-%COMP%]{padding:15px;flex:1}.producto-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5em;margin:0 0 10px;color:#fff}.producto-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;color:#929292}.reserva[_ngcontent-%COMP%]{padding:15px;width:100%;box-sizing:border-box;border-top:1px solid #ddd;display:flex;gap:10px;align-items:center;justify-content:center}.reserva[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:70px;padding:8px;border:1px solid #ccc;border-radius:4px}.reserva[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 12px;border:none;background-color:var(--primary);color:#cacaca;border-radius:4px;cursor:pointer;transition:background-color .3s}.reserva[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}@media (max-width: 600px){.productos-container[_ngcontent-%COMP%]{align-items:center;gap:5vw}.producto-card[_ngcontent-%COMP%]{width:45%;margin-bottom:20px}.producto-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:150px;margin-top:1vw}.producto-info[_ngcontent-%COMP%]{padding:.4vw 2.5vw}.producto-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2em}.producto-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1em}.reserva[_ngcontent-%COMP%]{padding:10px}.reserva[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:25%;padding:6px}}.toast[_ngcontent-%COMP%]{position:fixed;top:2.5rem;left:50%;transform:translate(-50%);background:#23243a;color:#fff;padding:1rem 2.2rem 1rem 1.2rem;border-radius:.7rem;box-shadow:0 2px 16px #4c3fff2e;font-size:1.08em;font-weight:500;z-index:9999;display:flex;align-items:center;gap:.7em;opacity:0;pointer-events:none;transition:opacity .4s,top .4s}.toast.show[_ngcontent-%COMP%]{opacity:1;pointer-events:auto;top:2.5rem}.toast-icon[_ngcontent-%COMP%]{color:#ff4d6d;font-size:1.5em;margin-right:.5em}"]})}}return e})();export{Q as a,K as b,xt as c};
