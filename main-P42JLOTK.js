import{a as bt,b as de,c as Se,d as xt}from"./chunk-NIECMA2Y.js";import{a as Ot,b as yt,c as kt,d as Et}from"./chunk-5M56KQ77.js";import{a as W}from"./chunk-XRND4IBA.js";import{a as Ne,b as G,c as Tt}from"./chunk-SJJ7AS6V.js";import{a as V}from"./chunk-YUYFXWSA.js";import{a as Le}from"./chunk-JSMESB4G.js";import{a as q}from"./chunk-Z2OSFF7B.js";import{a as Pe,b as ht,c as I,d as K}from"./chunk-NTR4IU7O.js";import{a as mt,b as Me,c as ft,d as N,e as U,f as _t,g as Ct,h as De}from"./chunk-6PM5SZDC.js";import{a as Be,b as B,c as A,d as ee,e as te,f as R,g as ne,h as Ae,i as vt,j as wt,k as Mt,l as Pt,m as Re,n as me,p as St,q as D}from"./chunk-YEOPWMZ4.js";import{$a as _,$b as dt,Ab as M,Bb as P,Cb as S,Da as L,E as ze,Eb as X,Fa as Ce,Fb as ct,Ga as s,Gb as y,Hb as T,Ib as le,Ka as g,Kb as lt,P as Ge,Pa as v,Sa as rt,U as _e,Ua as f,Z as se,_ as Y,_a as Ee,_b as Ie,aa as nt,ab as ce,ac as Ve,bb as Te,bc as H,cb as p,cc as we,db as je,dc as k,e as Oe,ea as it,eb as he,fa as h,fb as F,ga as b,gb as z,ha as Q,hb as o,ia as ue,ib as r,jb as C,k as ye,kb as at,kc as pt,l as et,lb as w,lc as ut,mb as u,mc as gt,nb as m,oa as ke,ob as J,pb as st,qb as $e,s as Fe,sa as ot,sb as be,t as tt,tb as xe,ub as ve,vb as c,wb as x,xb as E}from"./chunk-BA2Q6BYO.js";var Z=()=>{let t=Y(I),l=Y(N);return t.tokenUsuario?!0:l.createUrlTree(["/inicio-sesion"])};var jt=(()=>{class t{generarPasswordSegura(e=14){let i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()-_=+[]{};:,.<>?",n="";for(;n=Array.from({length:e},()=>i[Math.floor(Math.random()*i.length)]).join(""),!(/[a-z]/.test(n)&&/[A-Z]/.test(n)&&/[0-9]/.test(n)&&/[^A-Za-z0-9]/.test(n)););return n}calcularFortaleza(e){let i=0;return e.length>=6&&i++,/[A-Z]/.test(e)&&i++,/[a-z]/.test(e)&&i++,/[0-9]/.test(e)&&i++,/[^A-Za-z0-9]/.test(e)&&i++,e.length>12&&i++,!e||e.length<6?{texto:"",clase:""}:i<=2?{texto:"D\xE9bil",clase:"debil"}:i<=4?{texto:"Media",clase:"media"}:{texto:"Fuerte",clase:"fuerte"}}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=_e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function dn(t,l){if(t&1&&(o(0,"label"),c(1),r()),t&2){let e=m();s(),x(e.label)}}function mn(t,l){if(t&1){let e=w();o(0,"div",5)(1,"span"),c(2,"Generar contrase\xF1a aleatoria"),r(),o(3,"button",8),u("click",function(){h(e);let n=m();return b(n.generarPassword())}),C(4,"img",9),r()()}}function pn(t,l){t&1&&c(0,"\u2714\uFE0F")}function un(t,l){t&1&&c(0,"\u274C")}function gn(t,l){if(t&1&&(o(0,"ul",6)(1,"li")(2,"span",10),f(3,pn,1,0)(4,un,1,0),r(),c(5," M\xEDnimo 6 caracteres "),r()()),t&2){let e=m();s(),ce("cumplido",e.password.length>=6),s(2),p(e.password.length>=6?3:4)}}function fn(t,l){if(t&1&&(o(0,"div"),c(1),r()),t&2){let e=m();Te("fortaleza ",e.fortaleza.clase,""),s(),E(" Fortaleza: ",e.fortaleza.texto," ")}}var We=(()=>{class t{constructor(e){this.passwordService=e,this.label="",this.placeholder="",this.required=!1,this.showStrength=!1,this.showGenerator=!1,this.value="",this.mostrarRequisitos=!1,this.valueChange=new ke,this.passwordGenerada=new ke,this.password="",this.mostrar=!1,this.fortaleza={texto:"",clase:""}}ngOnInit(){this.password=this.value,this.onPasswordChange()}ngOnChanges(){this.password=this.value,this.showStrength&&(this.fortaleza=this.passwordService.calcularFortaleza(this.password))}onPasswordChange(){this.valueChange.emit(this.password),this.showStrength&&(this.fortaleza=this.passwordService.calcularFortaleza(this.password))}generarPassword(){this.password=this.passwordService.generarPasswordSegura(),this.onPasswordChange(),this.passwordGenerada.emit(this.password)}mostrarRequisitosFn(){return this.mostrarRequisitos&&this.password.length>0}static{this.\u0275fac=function(i){return new(i||t)(g(jt))}}static{this.\u0275cmp=v({type:t,selectors:[["app-password-field"]],inputs:{label:"label",placeholder:"placeholder",required:"required",showStrength:"showStrength",showGenerator:"showGenerator",value:"value",mostrarRequisitos:"mostrarRequisitos"},outputs:{valueChange:"valueChange",passwordGenerada:"passwordGenerada"},features:[it],decls:9,vars:10,consts:[[1,"password-field"],[1,"input-group"],[1,"input-password",3,"ngModelChange","type","ngModel","required"],["type","button",1,"btn-ojo",3,"click"],["width","22","height","22","alt","Mostrar/Ocultar",3,"src"],[1,"aleatorio-group"],[1,"password-requisitos"],[3,"class"],["type","button","aria-label","Generar contrase\xF1a",1,"btn-generar",3,"click"],["src","svgs/icono-dado.svg","width","22","height","22","alt","Generar contrase\xF1a"],[1,"icono-requisito"]],template:function(i,n){i&1&&(o(0,"div",0),f(1,dn,2,1,"label"),o(2,"div",1)(3,"input",2),S("ngModelChange",function(d){return P(n.password,d)||(n.password=d),d}),u("ngModelChange",function(){return n.onPasswordChange()}),r(),o(4,"button",3),u("click",function(){return n.mostrar=!n.mostrar}),C(5,"img",4),r(),f(6,mn,5,0,"div",5),r(),f(7,gn,6,3,"ul",6)(8,fn,2,4,"div",7),r()),i&2&&(s(),p(n.label?1:-1),s(2),_("type",n.mostrar?"text":"password"),M("ngModel",n.password),_("required",n.required),Ee("placeholder",n.placeholder),s(),Ee("aria-label",n.mostrar?"Ocultar":"Mostrar"),s(),_("src",n.mostrar?"svgs/icono-ojo.svg":"svgs/icono-ojo-off.svg",L),s(),p(n.showGenerator?6:-1),s(),p(n.mostrarRequisitosFn()?7:-1),s(),p(n.showStrength&&n.fortaleza.texto?8:-1))},dependencies:[D,B,A,me,R],styles:[".password-field[_ngcontent-%COMP%]{width:100%}label[_ngcontent-%COMP%]{color:#bfc4d1;font-size:1rem;font-weight:500;margin-bottom:.2rem}.input-group[_ngcontent-%COMP%]{position:relative;width:100%}.input-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{width:100%;box-sizing:border-box;background:#23243a;border:1.5px solid #35355a;border-radius:.5rem;padding:.7rem 1rem;color:#fff;font-size:1rem;transition:border .2s;outline:none}button[_ngcontent-%COMP%]{transition:all .3s}.btn-ojo[_ngcontent-%COMP%]{position:absolute;right:0;background:transparent;border:none}button[_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:hover{outline:none;border-color:transparent}.btn-generar[_ngcontent-%COMP%]{padding:0;display:flex;align-items:center;justify-content:center}button[_ngcontent-%COMP%]:hover{transform:scale(1.2)}.aleatorio-group[_ngcontent-%COMP%]{margin-top:.4vw;width:100%;display:flex;align-items:center;justify-content:flex-end;gap:.5rem}.fortaleza[_ngcontent-%COMP%]{margin-top:.4rem;height:1.2rem;border-radius:6px;display:flex;align-items:center;font-size:.95rem;font-weight:500;padding-left:.7rem;background:#23272f;color:#fff;border:1px solid #444a57;transition:background .2s,color .2s}.fortaleza.debil[_ngcontent-%COMP%]{background:#3a2323;color:#ff6b6b;border-color:#ff6b6b44}.fortaleza.media[_ngcontent-%COMP%]{background:#2e2e1e;color:#ffd166;border-color:#ffd16644}.fortaleza.fuerte[_ngcontent-%COMP%]{background:#1e322e;color:#06d6a0;border-color:#06d6a044}.password-requisitos[_ngcontent-%COMP%]{list-style:none;padding:0 0 0 .2rem;margin:.3rem 0 .2rem}.password-requisitos[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center;color:#bfc7d5;font-size:.97rem;margin-bottom:.1rem;gap:.5rem;transition:color .2s}.password-requisitos[_ngcontent-%COMP%]   li.cumplido[_ngcontent-%COMP%]{color:#06d6a0;font-weight:600}"]})}}return t})();function Cn(t,l){if(t&1&&(o(0,"p",7),c(1),r()),t&2){let e=m();s(),x(e.mensajeErrorUsername)}}function hn(t,l){if(t&1&&(o(0,"p",7),c(1),r()),t&2){let e=m();s(),x(e.mensajeErrorEmail)}}var Ft=(()=>{class t{constructor(e,i,n,a,d){this.usuariosService=e,this.datosService=i,this.router=n,this.toastService=a,this.validacionesService=d,this.username="",this.nombre="",this.email="",this.barbero=!0,this.password="",this.confirmPassword="",this.usernameValido=!1,this.emailValido=!1,this.mensajeErrorUsername="",this.mensajeErrorEmail="",this.esCliente=!this.barbero}registrarUsuario(){if(this.password!==this.confirmPassword){this.toastService.error("Las contrase\xF1as no coinciden.");return}let e={username:this.username.trim(),nombre:this.nombre.trim(),email:this.email.trim(),barbero:this.barbero,password:this.password};this.usuariosService.registrar(e).subscribe({next:i=>{localStorage.setItem("token",i.token),this.datosService.tokenUsuario=i.token,localStorage.setItem("user",JSON.stringify(i.user)),this.datosService.user=i.user,this.router.navigate(["/mis-citas"])},error:i=>{this.toastService.error(i)}})}verificarUsername(){if(!this.username){this.usernameValido=!1,this.mensajeErrorUsername="";return}let e=this.validacionesService.validarUsername(this.username);if(e){this.usernameValido=!1,this.mensajeErrorUsername=e;return}this.usuariosService.validarUsername(this.username).subscribe({next:i=>{this.usernameValido=i.valido,this.mensajeErrorUsername=""},error:i=>{this.usernameValido=!1,this.mensajeErrorUsername=i.error}})}verificarEmail(){if(!this.email){this.emailValido=!1,this.mensajeErrorEmail="";return}let e=this.validacionesService.validarEmail(this.email);if(e){this.emailValido=!1,this.mensajeErrorEmail=e;return}this.usuariosService.verificarEmail(this.email).subscribe({next:i=>{this.emailValido=!i.exists,this.mensajeErrorEmail=i.exists?"El correo electr\xF3nico ya est\xE1 en uso.":""},error:i=>{this.emailValido=!1,this.mensajeErrorEmail=i.error}})}onPasswordGenerada(e){this.confirmPassword=e}static{this.\u0275fac=function(i){return new(i||t)(g(W),g(I),g(N),g(q),g(Le))}}static{this.\u0275cmp=v({type:t,selectors:[["app-register"]],decls:36,vars:17,consts:[[1,"component-container"],[1,"form-container"],[1,"title"],[1,"form",3,"ngSubmit"],[1,"input-group"],["for","username"],["type","text","id","username","name","username","required","",3,"ngModelChange","blur","ngModel"],[1,"error"],["for","nombre"],["type","text","id","nombre","name","nombre","maxlength","100","required","",3,"ngModelChange","ngModel"],["for","email"],["type","email","id","email","name","email","required","",3,"ngModelChange","blur","ngModel"],["label","Contrase\xF1a",3,"valueChange","passwordGenerada","value","showStrength","showGenerator","mostrarRequisitos","required"],["label","Confirmar Contrase\xF1a",3,"valueChange","value","showStrength","showGenerator","required"],["type","checkbox","name","barbero",3,"ngModelChange","change","ngModel"],["type","checkbox","name","cliente",3,"ngModelChange","change","ngModel"],["type","submit",1,"sign",3,"disabled"],[1,"signup"],["routerLink","/inicio-sesion"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div",1)(2,"p",2),c(3,"Registro"),r(),o(4,"form",3),u("ngSubmit",function(){return n.registrarUsuario()}),o(5,"div",4)(6,"label",5),c(7,"Username"),r(),o(8,"input",6),S("ngModelChange",function(d){return P(n.username,d)||(n.username=d),d}),u("blur",function(){return n.verificarUsername()}),r(),f(9,Cn,2,1,"p",7),r(),o(10,"div",4)(11,"label",8),c(12,"Nombre"),r(),o(13,"input",9),S("ngModelChange",function(d){return P(n.nombre,d)||(n.nombre=d),d}),r()(),o(14,"div",4)(15,"label",10),c(16,"Correo Electr\xF3nico"),r(),o(17,"input",11),S("ngModelChange",function(d){return P(n.email,d)||(n.email=d),d}),u("blur",function(){return n.verificarEmail()}),r(),f(18,hn,2,1,"p",7),r(),o(19,"div",4)(20,"app-password-field",12),S("valueChange",function(d){return P(n.password,d)||(n.password=d),d}),u("passwordGenerada",function(d){return n.onPasswordGenerada(d)}),r()(),o(21,"div",4)(22,"app-password-field",13),S("valueChange",function(d){return P(n.confirmPassword,d)||(n.confirmPassword=d),d}),r()(),o(23,"div",4)(24,"label")(25,"input",14),S("ngModelChange",function(d){return P(n.barbero,d)||(n.barbero=d),d}),u("change",function(){return n.esCliente=!n.barbero}),r(),c(26," Barbero "),r(),o(27,"label")(28,"input",15),S("ngModelChange",function(d){return P(n.esCliente,d)||(n.esCliente=d),d}),u("change",function(){return n.barbero=!n.esCliente}),r(),c(29," Cliente "),r()(),o(30,"button",16),c(31," Registrar "),r(),o(32,"p",17),c(33,"\xBFYa tienes cuenta? "),o(34,"a",18),c(35,"Iniciar sesi\xF3n"),r()()()()()),i&2&&(s(8),M("ngModel",n.username),s(),p(!n.usernameValido&&n.mensajeErrorUsername?9:-1),s(4),M("ngModel",n.nombre),s(4),M("ngModel",n.email),s(),p(!n.emailValido&&n.mensajeErrorEmail?18:-1),s(2),M("value",n.password),_("showStrength",!0)("showGenerator",!0)("mostrarRequisitos",!0)("required",!0),s(2),M("value",n.confirmPassword),_("showStrength",!1)("showGenerator",!1)("required",!0),s(3),M("ngModel",n.barbero),s(3),M("ngModel",n.esCliente),s(2),_("disabled",!n.usernameValido||!n.emailValido||n.username===""||n.email===""||n.password===""||n.confirmPassword===""))},dependencies:[D,ne,B,Be,A,ee,me,St,R,te,U,We],styles:[".form-container[_ngcontent-%COMP%]{border-radius:1.2rem;max-width:420px;width:100%;margin:0 auto;display:flex;flex-direction:column;align-items:center}.title[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;color:#fff;margin-bottom:1.5rem;letter-spacing:1px;text-align:center}.form[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:1.2rem}.input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.4rem}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#bfc4d1;font-size:1rem;font-weight:500;margin-bottom:.2rem}.input-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], .input-group[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{background:#23243a;border:1.5px solid #35355a;border-radius:.5rem;padding:.7rem 1rem;color:#fff;font-size:1rem;transition:border .2s;outline:none}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border:1.5px solid #6c63ff;background:#23243a}.input-group[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:#ff4d6d;font-size:.95em;margin-top:.1em;font-weight:500}.input-group[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{accent-color:#6c63ff;margin-right:.5em;width:1.1em;height:1.1em}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5em;font-size:1em;font-weight:500;color:#bfc4d1}.input-group[_ngcontent-%COMP%]   label[for][_ngcontent-%COMP%]{margin-bottom:.2em}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:not([for]){margin-bottom:0;font-weight:400;color:#bfc4d1}.sign[_ngcontent-%COMP%]{display:block;width:100%;background:linear-gradient(120deg,red,#fff 45% 55%,#2212ff);padding:.75rem;text-align:center;color:#111827;border:none;border-radius:.375rem;font-weight:600;background-size:160% 160%;background-position:0% 0%;transition:background-position .4s ease-in-out;font-size:1.1rem;margin-top:.7rem;box-shadow:0 2px 8px #4c3fff1a;cursor:pointer}.sign[_ngcontent-%COMP%]:disabled{background:#35355a;color:#bfc4d1;cursor:not-allowed}.sign[_ngcontent-%COMP%]:hover:not(:disabled){background-position:100% 100%}.signup[_ngcontent-%COMP%]{color:#bfc4d1;font-size:1em;margin-top:1.2rem;text-align:center}.signup[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#6c63ff;text-decoration:none;font-weight:600;margin-left:.3em;transition:color .2s}.signup[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#483bff}.toast[_ngcontent-%COMP%]{position:fixed;top:2.5rem;left:50%;transform:translate(-50%);background:#23243a;color:#fff;padding:1rem 2.2rem 1rem 1.2rem;border-radius:.7rem;box-shadow:0 2px 16px #4c3fff2e;font-size:1.08em;font-weight:500;z-index:9999;display:flex;align-items:center;gap:.7em;opacity:0;pointer-events:none;transition:opacity .4s,top .4s}.toast.show[_ngcontent-%COMP%]{opacity:1;pointer-events:auto;top:2.5rem}.toast-icon[_ngcontent-%COMP%]{color:#ff4d6d;font-size:1.5em;margin-right:.5em}@media (max-width: 600px){.form-container[_ngcontent-%COMP%]{padding:1.2rem .7rem;max-width:98vw;border-radius:.7rem}.title[_ngcontent-%COMP%]{font-size:1.5rem}.form[_ngcontent-%COMP%]{gap:.7rem}.sign[_ngcontent-%COMP%]{font-size:1em;padding:.7rem 0}}"]})}}return t})();var zt=(()=>{class t{constructor(e,i,n,a){this.usuariosService=e,this.datosService=i,this.router=n,this.toastService=a,this.username="",this.password=""}iniciarSesion(){let e={username:this.username,password:this.password};if(!e.username||!e.password){this.toastService.error("Debes rellenar todos los campos. Por favor, introduce tu usuario y contrase\xF1a.");return}this.usuariosService.login(e).subscribe({next:i=>{this.datosService.tokenUsuario=i.token,this.datosService.user=i.user,localStorage.setItem("token",i.token),localStorage.setItem("user",JSON.stringify(i.user)),this.router.navigate(["/mis-citas"])},error:i=>{this.toastService.error(i)}})}static{this.\u0275fac=function(i){return new(i||t)(g(W),g(I),g(N),g(q))}}static{this.\u0275cmp=v({type:t,selectors:[["app-login"]],decls:23,vars:3,consts:[[1,"component-container"],[1,"form-container"],[1,"title"],[1,"form",3,"ngSubmit"],[1,"input-group"],["for","username"],["type","text","name","username","id","username","placeholder","","required","",3,"ngModelChange","ngModel"],["for","password"],["type","password","name","password","id","password","placeholder","","required","",3,"ngModelChange","ngModel"],[1,"forgot"],["routerLink","/recuperar-password","rel","noopener noreferrer"],[1,"sign",3,"disabled"],[1,"signup"],["routerLink","/registro",1,""]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div",1)(2,"p",2),c(3,"Iniciar Sesi\xF3n"),r(),C(4,"app-toast"),o(5,"form",3),u("ngSubmit",function(){return n.iniciarSesion()}),o(6,"div",4)(7,"label",5),c(8,"Username"),r(),o(9,"input",6),S("ngModelChange",function(d){return P(n.username,d)||(n.username=d),d}),r()(),o(10,"div",4)(11,"label",7),c(12,"Contrase\xF1a"),r(),o(13,"input",8),S("ngModelChange",function(d){return P(n.password,d)||(n.password=d),d}),r(),o(14,"div",9)(15,"a",10),c(16,"\xBFHas olvidado tu contrase\xF1a?"),r()()(),o(17,"button",11),c(18,"Iniciar Sesi\xF3n"),r()(),o(19,"p",12),c(20,"No tienes cuenta? "),o(21,"a",13),c(22,"Crear una"),r()()()()),i&2&&(s(9),M("ngModel",n.username),s(4),M("ngModel",n.password),s(4),_("disabled",!n.username||!n.password))},dependencies:[D,ne,B,A,ee,me,R,te,U,k,Ne],styles:[".form-container[_ngcontent-%COMP%]{border-radius:1.2rem;max-width:420px;width:100%;margin:0 auto;display:flex;flex-direction:column;align-items:center}.title[_ngcontent-%COMP%]{text-align:center;font-size:2.2rem;font-weight:700;color:#fff;margin-bottom:1.5rem;letter-spacing:1px}.form[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:1.2rem;margin-top:0}.input-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.4rem;font-size:1rem;line-height:1.25rem;margin-top:0}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#bfc4d1;font-size:1rem;font-weight:500;margin-bottom:.2rem;display:flex;align-items:center;gap:.5em}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:.5rem;border:1.5px solid #35355a;outline:0;background-color:#23243a;padding:.7rem 1rem;color:#fff;box-sizing:border-box;font-size:1rem;transition:border .2s}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border:1.5px solid #6c63ff;background:#23243a}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover{box-shadow:0 0 0 .15vw #4c3fff1f}.forgot[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;font-size:.85rem;color:#bfc4d1;margin:8px 0 14px}.forgot[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .signup[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#6c63ff;text-decoration:none;font-size:14px;font-weight:600;transition:color .2s}.forgot[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .signup[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline;color:#483bff}.sign[_ngcontent-%COMP%]{display:block;width:100%;background:linear-gradient(120deg,red,#fff 45% 55%,#2212ff);padding:.75rem;text-align:center;color:#111827;border:none;border-radius:.375rem;font-weight:600;background-size:160% 160%;background-position:0% 0%;transition:background-position .4s ease-in-out;font-size:1.1rem;margin-top:.7rem;box-shadow:0 2px 8px #4c3fff1a;cursor:pointer}.sign[_ngcontent-%COMP%]:disabled{background:#35355a;color:#bfc4d1;cursor:not-allowed}.sign[_ngcontent-%COMP%]:hover:not(:disabled){background-position:100% 100%}.signup[_ngcontent-%COMP%]{text-align:center;font-size:1em;color:#bfc4d1;margin-top:1.2rem}.error-banner[_ngcontent-%COMP%]{background:#ff4d6d;color:#fff;padding:.7em 1em;border-radius:.5em;margin-bottom:1em;text-align:center;font-weight:600;box-shadow:0 2px 8px #ff4d6d1a}.error-hint[_ngcontent-%COMP%]{color:#ffe6e6;font-size:.98em;margin-top:.3em;font-weight:400;opacity:.95}@media (max-width: 600px){.form-container[_ngcontent-%COMP%]{padding:1.2rem .7rem;max-width:98vw;border-radius:.7rem}.title[_ngcontent-%COMP%]{font-size:1.5rem}.form[_ngcontent-%COMP%]{gap:.7rem}.sign[_ngcontent-%COMP%]{font-size:1em;padding:.7rem 0}}"]})}}return t})();function bn(t,l){t&1&&(o(0,"p",4),c(1,"Debes introducir una fecha futura"),r())}function xn(t,l){if(t&1&&(o(0,"th"),c(1),r()),t&2){let e=l.$implicit;s(),x(e.getDate())}}function vn(t,l){if(t&1){let e=w();o(0,"td")(1,"button",23),u("mousedown",function(){let n=h(e).$implicit,a=m().$implicit,d=m();return b(d.empezarSeleccion(n,a))})("mousemove",function(n){let a=h(e).$implicit,d=m().$implicit,O=m();return b(O.continuarSeleccion(a,d,n))})("mouseup",function(){h(e);let n=m(2);return b(n.terminarSeleccion())}),c(2),r()()}if(t&2){let e=l.$implicit,i=m().$implicit,n=m();s(),ce("selected",n.horaEnFranja(e,i))("subido",n.horaEnFranja(e,i,n.fechasSubidas)),s(),E(" ",i," ")}}function wn(t,l){if(t&1&&(o(0,"tr"),F(1,vn,3,5,"td",null,je),r()),t&2){let e=m();s(),z(e.diasDeLaSemana)}}var It=(()=>{class t{constructor(e){this.citasService=e,this.diasDeLaSemana=[],this.franjasHorarias=[],this.hoyString=new Date().toISOString().slice(0,10),this.inputFecha=this.hoyString,this.mostrarWarningInput=!1,this.idBarbero=parseInt(JSON.parse(localStorage.getItem("user")||"{}").id||"0",10),this.tramo={inicio:8,fin:17,ultimoInicio:8,ultimoFin:17},this.seleccionando=!1,this.agregando=!1,this.fechasSubidas=[],this.franjasSeleccionadas=[],this.ultimasFranjasSeleccionadas=[]}ngOnInit(){this.calcularSemana(new Date),this.actualizarTramo()}cambiarSemana(e){this.calcularSemana(this.diasDeLaSemana[0],e),this.inputFecha=this.desactivarAtras()?this.hoyString:this.diasDeLaSemana[0].toISOString().slice(0,10),this.cambioFecha(),this.recargarFechasSubidas()}cambioFecha(){let e=new Date,i=new Date(this.inputFecha);!this.inputFecha||i.getTime()+1e3*60*60*24<e.getTime()?(this.mostrarWarningInput=!!this.inputFecha,this.inputFecha=e.toISOString().slice(0,10),i=new Date(this.inputFecha)):this.mostrarWarningInput=!1,this.calcularSemana(i)}calcularSemana(e,i=0){this.diasDeLaSemana=this.citasService.calcularSemana(e,i),this.recargarFechasSubidas()}desactivarAtras(){return this.diasDeLaSemana[0].getTime()<=new Date().getTime()}recargarFechasSubidas(){this.citasService.getCitas(this.idBarbero,this.diasDeLaSemana[0]).subscribe({next:e=>{this.fechasSubidas=e.totales}})}horaEnFranja(e,i,n=this.franjasSeleccionadas){return n[e.getDate()]?.includes(i)}empezarSeleccion(e,i){this.seleccionando=!0,this.ultimasFranjasSeleccionadas=this.franjasSeleccionadas,this.agregando=!this.horaEnFranja(e,i),this.alternarSeleccion(e,i)}continuarSeleccion(e,i,n){let a=this.horaEnFranja(e,i,this.ultimasFranjasSeleccionadas);this.seleccionando&&n.buttons===1&&!a&&this.agregando?this.alternarSeleccion(e,i):this.seleccionando&&n.buttons===1&&a&&!this.agregando&&this.alternarSeleccion(e,i)}terminarSeleccion(){this.seleccionando=!1}alternarSeleccion(e,i){if(!this.horaEnFranja(e,i))this.franjasSeleccionadas[e.getDate()]||(this.franjasSeleccionadas[e.getDate()]=[]),this.franjasSeleccionadas[e.getDate()].push(i);else{let n=this.franjasSeleccionadas[e.getDate()].indexOf(i);this.franjasSeleccionadas[e.getDate()].splice(n,1)}}confirmarSeleccion(){let e=[];for(let i in this.franjasSeleccionadas)for(let n of this.franjasSeleccionadas[i]){let a=this.diasDeLaSemana.findIndex(d=>d.getDate()===parseInt(i));e.push(this.citasService.diaHora(this.diasDeLaSemana[a],n))}this.citasService.subirCitas(this.idBarbero,e).subscribe({next:()=>{this.franjasSeleccionadas=[],this.recargarFechasSubidas()},error:()=>{alert("No se han podido subir las citas")}})}cancelarSeleccion(){this.franjasSeleccionadas=[]}actualizarTramo(){if(this.tramo.inicio>=this.tramo.fin||this.tramo.inicio<0||this.tramo.fin>24){this.tramo.inicio=this.tramo.ultimoInicio,this.tramo.fin=this.tramo.ultimoFin;return}this.tramo.ultimoInicio=this.tramo.inicio,this.tramo.ultimoFin=this.tramo.fin,this.franjasHorarias=this.citasService.generarFranjasHorarias([this.tramo.inicio+":00",this.tramo.fin-1+":30"]),this.franjasSeleccionadas=[],this.ultimasFranjasSeleccionadas=[]}static{this.\u0275fac=function(i){return new(i||t)(g(de))}}static{this.\u0275cmp=v({type:t,selectors:[["app-crear-citas"]],decls:41,vars:11,consts:[[1,"component-container"],[1,"titulo"],[1,"input-fecha-container"],["type","date",1,"input-fecha",3,"ngModelChange","change","ngModel"],[2,"color","red"],[1,"botones-cambio-semana"],["aria-label","Semana anterior",3,"click","disabled"],["fill","#000000","viewBox","0 0 24 24","id","left-arrow","data-name","Flat Line","xmlns","http://www.w3.org/2000/svg",1,"icon","flat-line"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["id","primary","x1","21","y1","12","x2","3","y2","12",2,"fill","none","stroke","#ffffff","stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],["id","primary-2","data-name","primary","points","6 9 3 12 6 15",2,"fill","none","stroke","#ffffff","stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],["aria-label","Semana siguiente",3,"click"],["fill","#000000","viewBox","0 0 24 24","id","right-arrow","data-name","Flat Line","xmlns","http://www.w3.org/2000/svg",1,"icon","flat-line"],["id","primary","x1","3","y1","12","x2","21","y2","12",2,"fill","none","stroke","#ffffff","stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],["id","primary-2","data-name","primary","points","18 15 21 12 18 9",2,"fill","none","stroke","#ffffff","stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"botones"],[1,"btn-confirmar",3,"click"],[1,"btn-cancelar",3,"click"],[1,"input-tramos"],["type","number",3,"ngModelChange","change","blur","min","max","ngModel"],["type","number","max","24",3,"ngModelChange","change","blur","min","ngModel"],[3,"mousedown","mousemove","mouseup"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"h2",1),c(2),y(3,"dateMesString"),r(),o(4,"div",2)(5,"input",3),S("ngModelChange",function(d){return P(n.inputFecha,d)||(n.inputFecha=d),d}),u("change",function(){return n.cambioFecha()}),r(),f(6,bn,2,0,"p",4),r(),o(7,"div",5)(8,"div")(9,"button",6),u("click",function(){return n.cambiarSemana(-1)}),Q(),o(10,"svg",7),C(11,"g",8)(12,"g",9),o(13,"g",10),C(14,"line",11)(15,"polyline",12),r()()(),ue(),o(16,"button",13),u("click",function(){return n.cambiarSemana(1)}),Q(),o(17,"svg",14),C(18,"g",8)(19,"g",9),o(20,"g",10),C(21,"line",15)(22,"polyline",16),r()()()()(),ue(),o(23,"div",17)(24,"button",18),u("click",function(){return n.confirmarSeleccion()}),c(25,"Confirmar"),r(),o(26,"button",19),u("click",function(){return n.cancelarSeleccion()}),c(27,"Cancelar"),r()(),o(28,"p",20),c(29,"Mostrando tramos de "),o(30,"input",21),S("ngModelChange",function(d){return P(n.tramo.inicio,d)||(n.tramo.inicio=d),d}),u("change",function(){return n.actualizarTramo()})("blur",function(){return n.actualizarTramo()}),r(),c(31," a "),o(32,"input",22),S("ngModelChange",function(d){return P(n.tramo.fin,d)||(n.tramo.fin=d),d}),u("change",function(){return n.actualizarTramo()})("blur",function(){return n.actualizarTramo()}),r()(),o(33,"table")(34,"thead")(35,"tr"),F(36,xn,2,1,"th",null,je),r()(),o(38,"tbody"),F(39,wn,3,0,"tr",null,he),r()()()),i&2&&(s(2),x(T(3,9,n.diasDeLaSemana[6])),s(3),M("ngModel",n.inputFecha),s(),p(n.mostrarWarningInput?6:-1),s(3),_("disabled",n.desactivarAtras()),s(21),_("min",0)("max",n.tramo.fin-1),M("ngModel",n.tramo.inicio),s(2),_("min",n.tramo.inicio+1),M("ngModel",n.tramo.fin),s(4),z(n.diasDeLaSemana),s(3),z(n.franjasHorarias))},dependencies:[bt,D,B,Ae,A,Re,Pt,R],styles:[".component-container[_ngcontent-%COMP%]{max-width:80vw;margin:40px auto;background:#39445a18;border-radius:22px;box-shadow:0 4px 70px #4a74c940;padding:20px 32px 32px;display:flex;flex-direction:column;align-items:center}h2[_ngcontent-%COMP%]{font-family:Montserrat,ui-sans-serif,system-ui,sans-serif;color:#eaf0fa;margin-bottom:22px;letter-spacing:1px;margin-top:10px}.botones-cambio-semana[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;margin-bottom:32px}.botones[_ngcontent-%COMP%]{display:flex;gap:18px;margin-bottom:8px}.botones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus, .botones-cambio-semana[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}.botones-cambio-semana[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{top:-16px;position:absolute;display:flex;align-items:center;justify-content:center;gap:130px}.botones-cambio-semana[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;color:#eaf0fa;border:none;width:45px;height:45px;box-sizing:border-box;transition:background .2s,color .2s,box-shadow .2s;font-size:2rem;padding:0}.botones-cambio-semana[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled   *[_ngcontent-%COMP%]{stroke:#313131!important;cursor:not-allowed}.input-tramos[_ngcontent-%COMP%]{width:100%;padding-left:2vw}table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;background:#23272f;border-radius:14px;overflow:hidden;box-shadow:0 2px 12px -8px #000a}tr[_ngcontent-%COMP%]{width:100%;display:flex}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:12px 0;border-bottom:1px solid #353b48;font-size:1.13rem;margin:auto}th[_ngcontent-%COMP%]{background:#2d323c;color:#eaf0fa;font-weight:600;width:100%}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}td[_ngcontent-%COMP%]{flex:1;padding:12px 16px;text-align:center;box-sizing:border-box}td[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:10px 0;border-radius:7px;border:none;font-size:1.05rem;font-family:inherit;background:#353b48;color:#eaf0fa;transition:background .2s,color .2s,box-shadow .2s;box-shadow:0 1px 4px -2px #0008;margin:2px 0}td[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#eaf73c;color:#23272f}td[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{background:#4caf50;color:#fff;font-weight:600}td[_ngcontent-%COMP%]   button.subido[_ngcontent-%COMP%]{background:#ffe066;color:#23272f;font-weight:600}td[_ngcontent-%COMP%]   button.subido.selected[_ngcontent-%COMP%]{background:#af5b4c;color:#fff}.btn-confirmar[_ngcontent-%COMP%]{background:#4caf50;color:#fff;border:none;border-radius:8px;padding:12px 32px;font-size:1.1rem;font-weight:600;cursor:pointer;margin-right:10px;transition:background .2s,transform .15s}.btn-confirmar[_ngcontent-%COMP%]:hover{background:#43a047;transform:scale(1.04)}.btn-cancelar[_ngcontent-%COMP%]{background:#e53935;color:#fff;border:none;border-radius:8px;padding:12px 32px;font-size:1.1rem;font-weight:600;cursor:pointer;transition:background .2s,transform .15s}.btn-cancelar[_ngcontent-%COMP%]:hover{background:#b71c1c;transform:scale(1.04)}.input-fecha-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:0}.input-fecha[_ngcontent-%COMP%]{background:#23272f;color:#eaf0fa;border:1.5px solid #353b48;border-radius:8px;padding:10px 18px;font-size:1.08rem;font-family:inherit;margin-bottom:6px;outline:none;transition:border .2s,box-shadow .2s;box-shadow:0 1px 4px -2px #0008}.input-fecha[_ngcontent-%COMP%]:focus{border:1.5px solid #4caf50;box-shadow:0 2px 8px -4px #4caf5040}.input-fecha[_ngcontent-%COMP%]::-webkit-calendar-picker-indicator{filter:invert(1)}.input-fecha-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.98rem;color:#ff5f5f}@media (max-width: 600px){.component-container[_ngcontent-%COMP%]{padding:10px 2vw;max-width:99vw;margin:0}table[_ngcontent-%COMP%]{font-size:.97rem}table[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{font-size:.9rem!important}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:7px 0}}body[_ngcontent-%COMP%]{background:#181a20}"]})}}return t})();var Mn=t=>["/",t],Pn=(t,l)=>l.id;function Sn(t,l){if(t&1&&(o(0,"li",6)(1,"div",3),c(2),y(3,"date"),r(),o(4,"div",4),c(5),r(),o(6,"div",5)(7,"a",9),c(8),r()()()),t&2){let e=l.$implicit;s(2),x(le(3,4,e.fecha_hora,"dd/MM HH:mm")),s(3),x(e.usuario_nombre),s(2),_("routerLink",X(7,Mn,e.usuario_username)),s(),E(" ","@"+e.usuario_username," ")}}var Ue=(()=>{class t{constructor(){this.citas=[],this.pagina=0,this.limite=20,this.paginaCambiada=new ke}anteriorPagina(){this.pagina>0&&this.paginaCambiada.emit(this.pagina-1)}siguientePagina(){this.citas.length>=this.limite&&this.paginaCambiada.emit(this.pagina+1)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=v({type:t,selectors:[["mis-citas-tabla"]],inputs:{citas:"citas",pagina:"pagina",limite:"limite"},outputs:{paginaCambiada:"paginaCambiada"},decls:18,vars:3,consts:[[1,"tabla-wrapper"],[1,"tabla-ul"],[1,"header"],[1,"col","col-1"],[1,"col","col-2"],[1,"col","col-3"],[1,"row"],[1,"paginacion"],[3,"click","disabled"],[3,"routerLink"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"ul",1)(2,"li",2)(3,"div",3),c(4,"Fecha"),r(),o(5,"div",4),c(6,"Nombre"),r(),o(7,"div",5),c(8,"Usuario"),r()(),F(9,Sn,9,9,"li",6,Pn),r(),o(11,"div",7)(12,"button",8),u("click",function(){return n.anteriorPagina()}),c(13,"Anterior"),r(),o(14,"span"),c(15),r(),o(16,"button",8),u("click",function(){return n.siguientePagina()}),c(17,"Siguiente"),r()()()),i&2&&(s(9),z(n.citas),s(3),_("disabled",n.pagina===0),s(3),E("P\xE1gina ",n.pagina+1,""),s(),_("disabled",n.citas.length<n.limite))},dependencies:[k,we,U],styles:["ul[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0;width:100%}li[_ngcontent-%COMP%]{border-radius:10px;padding:18px 24px;display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;background:var(--surface-alt, #292929);color:var(--text, #fffbe7);box-shadow:0 2px 10px #0002;transition:background .18s cubic-bezier(.4,0,.2,1),box-shadow .18s cubic-bezier(.4,0,.2,1),transform .15s cubic-bezier(.4,0,.2,1);font-size:1.18rem;position:relative;z-index:1;border-bottom:1px solid var(--border, #444);box-sizing:border-box}li.header[_ngcontent-%COMP%]{background-color:var(--bg, #242424);color:var(--primary, #ffd700);font-size:1.25rem;font-weight:700;text-transform:uppercase;letter-spacing:1px;box-shadow:0 2px 8px #00000014;border-bottom:2px solid var(--primary-dark, #b8860b);margin-bottom:10px}li.row[_ngcontent-%COMP%]{background-color:var(--surface-alt, #292929);color:var(--text, #fffbe7);font-size:1.18rem;border-left:4px solid var(--primary, #ffd700)}li.row[_ngcontent-%COMP%]:hover{background:#23231f;border-left:4px solid var(--primary-dark, #b8860b);box-shadow:0 4px 18px #0003;transform:scale(1.012)}.col[_ngcontent-%COMP%]{padding:0 8px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.col-1[_ngcontent-%COMP%], .col-2[_ngcontent-%COMP%]{flex-basis:35%;min-width:120px}.col-3[_ngcontent-%COMP%]{flex-basis:30%;min-width:100px;text-align:right;color:var(--primary, #ffd700);font-weight:500}.tabla-wrapper[_ngcontent-%COMP%]{width:100%;margin-left:auto;margin-right:auto;overflow-x:auto;overflow-y:visible;margin-bottom:1rem;background:var(--bg, #242424);border-radius:12px;box-shadow:0 2px 10px #0002;padding:16px 0;scrollbar-width:none;-ms-overflow-style:none}.tabla-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.tabla-ul[_ngcontent-%COMP%]{list-style-type:none;padding:0;margin:0;min-width:800px;width:100%}.paginacion[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:12px;margin-top:16px}.paginacion[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;outline:none;background:var(--primary);color:#fffbe7;border-radius:6px;padding:6px 18px;font-weight:600;font-size:1rem;transition:background .18s,color .18s,box-shadow .18s;box-shadow:0 1px 4px #0002;cursor:pointer}.paginacion[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover, .paginacion[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{border:none!important;outline:none!important;background:var(--primary-dark);color:#23231f;box-shadow:0 2px 8px #0003}@media (max-width: 900px){li[_ngcontent-%COMP%], li.header[_ngcontent-%COMP%]{padding:14px 8px;font-size:1.05rem}.col-1[_ngcontent-%COMP%], .col-2[_ngcontent-%COMP%], .col-3[_ngcontent-%COMP%]{min-width:80px}li.header[_ngcontent-%COMP%]{font-size:1.1rem}}@media (max-width: 600px){ul[_ngcontent-%COMP%]{min-width:0;width:100%;padding:0 2vw}.tabla-ul[_ngcontent-%COMP%]{min-width:0;width:100%;padding:0;margin:0}li[_ngcontent-%COMP%], li.header[_ngcontent-%COMP%]{padding:6px 2px;font-size:.92rem;margin-bottom:10px;border-radius:7px}li.header[_ngcontent-%COMP%]{font-size:.98rem;letter-spacing:.5px;border-bottom-width:1.5px;margin-bottom:6px;padding:8px 2px}.col-1[_ngcontent-%COMP%], .col-2[_ngcontent-%COMP%], .col-3[_ngcontent-%COMP%]{min-width:48px;padding:0 2px;font-size:.85em}.col-3[_ngcontent-%COMP%]{text-align:right}.tabla-wrapper[_ngcontent-%COMP%]{padding:8px 0;border-radius:8px;margin-bottom:.5rem;box-shadow:0 1px 4px #0002}.paginacion[_ngcontent-%COMP%]{gap:6px;margin-top:8px}.paginacion[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:4px 10px;font-size:.95em;border-radius:5px}}"]})}}return t})();function On(t,l){if(t&1){let e=w();o(0,"mis-citas-tabla",2),u("paginaCambiada",function(n){h(e);let a=m(2);return b(a.cambiarPagina(n))}),r()}if(t&2){let e=m(2);_("citas",e.citas)("pagina",e.pagina)("limite",e.limite)}}function yn(t,l){t&1&&(o(0,"p",1),c(1,"No tienes citas pendientes"),r())}function kn(t,l){if(t&1&&f(0,On,1,3,"mis-citas-tabla",0)(1,yn,2,0,"p",1),t&2){let e=m();p(e.citas.length?0:1)}}var Vt=(()=>{class t{constructor(e,i){this.citasService=e,this.cargandoService=i,this.citas=[],this.pagina=0,this.limite=20}ngOnInit(){this.cargarCitas()}cargarCitas(){this.citasService.getCitasUsuario({limit:this.limite,offset:this.pagina*this.limite}).subscribe(e=>{this.citas=e,this.cargandoService.cargando=!1})}cambiarPagina(e){this.pagina=e,this.cargarCitas()}static{this.\u0275fac=function(i){return new(i||t)(g(de),g(V))}}static{this.\u0275cmp=v({type:t,selectors:[["app-citas-cliente"]],decls:1,vars:1,consts:[[3,"citas","pagina","limite"],[1,"vacio"],[3,"paginaCambiada","citas","pagina","limite"]],template:function(i,n){i&1&&f(0,kn,2,1),i&2&&p(n.cargandoService.cargando?-1:0)},dependencies:[Ue],encapsulation:2})}}return t})();function En(t,l){if(t&1){let e=w();o(0,"h3"),c(1,"Citas como Barbero"),r(),o(2,"mis-citas-tabla",1),u("paginaCambiada",function(n){h(e);let a=m(2);return b(a.cambiarPaginaBarbero(n))}),r()}if(t&2){let e=m(2);s(2),_("citas",e.citasComoBarbero)("pagina",e.paginaBarbero)("limite",e.limite)}}function Tn(t,l){if(t&1){let e=w();o(0,"h3"),c(1,"Citas como Cliente"),r(),o(2,"mis-citas-tabla",1),u("paginaCambiada",function(n){h(e);let a=m(2);return b(a.cambiarPaginaCliente(n))}),r()}if(t&2){let e=m(2);s(2),_("citas",e.citasComoCliente)("pagina",e.paginaCliente)("limite",e.limite)}}function jn(t,l){t&1&&(o(0,"p",0),c(1,"No tienes citas pendientes"),r())}function Fn(t,l){if(t&1&&f(0,En,3,3)(1,Tn,3,3)(2,jn,2,0,"p",0),t&2){let e=m();p(e.citasComoBarbero.length?0:-1),s(),p(e.citasComoCliente.length?1:e.citasComoBarbero.length==0?2:-1)}}var Dt=(()=>{class t{constructor(e,i){this.citasService=e,this.cargandoService=i,this.citasComoBarbero=[],this.citasComoCliente=[],this.paginaBarbero=0,this.paginaCliente=0,this.limite=20,this.pendientesCargas=2}finalizarCargando(){this.pendientesCargas--,this.pendientesCargas===0&&(this.cargandoService.cargando=!1,this.pendientesCargas=2)}cargarCitasBarbero(){this.citasService.getCitasBarbero({limit:this.limite,offset:this.paginaBarbero*this.limite}).subscribe({next:e=>{this.citasComoBarbero=e,this.finalizarCargando()}})}cargarCitasCliente(){this.citasService.getCitasUsuario({limit:this.limite,offset:this.paginaCliente*this.limite}).subscribe({next:e=>{this.citasComoCliente=e,this.finalizarCargando()}})}ngOnInit(){this.cargarCitasBarbero(),this.cargarCitasCliente()}cambiarPaginaBarbero(e){this.paginaBarbero=e,this.cargarCitasBarbero(),this.cargandoService.cargando=!1}cambiarPaginaCliente(e){this.paginaCliente=e,this.cargarCitasCliente(),this.cargandoService.cargando=!1}static{this.\u0275fac=function(i){return new(i||t)(g(de),g(V))}}static{this.\u0275cmp=v({type:t,selectors:[["app-citas-barbero"]],decls:1,vars:1,consts:[[1,"vacio"],[3,"paginaCambiada","citas","pagina","limite"]],template:function(i,n){i&1&&f(0,Fn,3,2),i&2&&p(n.cargandoService.cargando?-1:0)},dependencies:[Ue],encapsulation:2})}}return t})();var $=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=v({type:t,selectors:[["app-cargando"]],inputs:{mensaje:"mensaje"},decls:4,vars:1,consts:[[1,"loading-overlay"],[1,"spinner"],[1,"loading-message"]],template:function(i,n){i&1&&(o(0,"div",0),C(1,"div",1),o(2,"div",2),c(3),r()()),i&2&&(s(3),x(n.mensaje||"Cargando, por favor espera..."))},styles:[".loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0006;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:9999}.spinner[_ngcontent-%COMP%]{border:8px solid #f3f3f3;border-top:8px solid #1976d2;border-radius:50%;width:64px;height:64px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:20px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-message[_ngcontent-%COMP%]{color:#fff;font-size:1.2rem;font-weight:500;text-shadow:0 1px 4px #000}"]})}}return t})();function zn(t,l){t&1&&C(0,"app-cargando",3)}function In(t,l){t&1&&C(0,"app-citas-cliente")}function Vn(t,l){t&1&&C(0,"app-citas-barbero")}var Bt=(()=>{class t{constructor(e,i){this.datosService=e,this.cargandoService=i}static{this.\u0275fac=function(i){return new(i||t)(g(I),g(V))}}static{this.\u0275cmp=v({type:t,selectors:[["app-mis-citas"]],decls:8,vars:4,consts:[[1,"component-container"],[1,"tabla-container"],[1,"titulo"],["mensaje","Cargando citas..."]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2),c(3,"Citas"),r(),f(4,zn,1,0,"app-cargando",3),y(5,"async"),f(6,In,1,0,"app-citas-cliente")(7,Vn,1,0,"app-citas-barbero"),r()()),i&2&&(s(4),p(T(5,2,n.cargandoService.cargandoProlongado)?4:-1),s(2),p(n.datosService.esCliente()?6:n.datosService.esBarbero()?7:-1))},dependencies:[k,H,Vt,Dt,$],styles:[".tabla-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;flex-direction:column}app-citas-barbero[_ngcontent-%COMP%], app-citas-cliente[_ngcontent-%COMP%]{width:70%}@media (max-width: 600px){app-citas-barbero[_ngcontent-%COMP%], app-citas-cliente[_ngcontent-%COMP%]{width:100%}}"]})}}return t})();function Dn(t,l){t&1&&C(0,"app-cargando",2),t&2&&_("mensaje","Cargando solicitudes")}function Bn(t,l){if(t&1){let e=w();o(0,"tr",6),u("click",function(){let n=h(e).$implicit,a=m(2);return b(a.irPerfil(n.username))}),o(1,"td"),c(2),r(),o(3,"td"),c(4),r(),o(5,"td"),c(6),y(7,"date"),r(),o(8,"td")(9,"button",7),u("click",function(n){let a=h(e).$implicit;return m(2).aceptarSolicitud(a.id),b(n.stopPropagation())}),o(10,"span",8),Q(),o(11,"svg",9),C(12,"path",10),r()(),c(13," Aceptar "),r(),ue(),o(14,"button",11),u("click",function(n){let a=h(e).$implicit;return m(2).rechazarSolicitud(a.id),b(n.stopPropagation())}),o(15,"span",8),Q(),o(16,"svg",9),C(17,"line",12)(18,"line",13),r()(),c(19," Rechazar "),r()()()}if(t&2){let e=l.$implicit;s(2),x(e.nombre),s(2),x(e.username),s(2),x(le(7,3,e.fecha_creacion,"HH:mm dd/MM"))}}function An(t,l){if(t&1&&(o(0,"div",3)(1,"table")(2,"thead")(3,"tr")(4,"th"),c(5,"Nombre"),r(),o(6,"th"),c(7,"Usuario"),r(),o(8,"th"),c(9,"Fecha"),r()()(),o(10,"tbody"),F(11,Bn,20,6,"tr",5,je),r()()()),t&2){let e=m();s(11),z(e.solicitudes)}}function Rn(t,l){t&1&&(o(0,"p",4),c(1,"No hay solicitudes pendientes."),r())}var Rt=(()=>{class t{constructor(e,i,n){this.relacionesService=e,this.cargandoService=i,this.router=n,this.solicitudes=[]}ngOnInit(){this.relacionesService.getSolicitudes().subscribe({next:e=>{this.solicitudes=e}})}aceptarSolicitud(e){this.relacionesService.aceptarSolicitud(e).subscribe({next:()=>{this.solicitudes=this.solicitudes.filter(i=>i.id!==e)}})}rechazarSolicitud(e){this.relacionesService.rechazarSolicitud(e.id).subscribe({next:()=>{this.solicitudes=this.solicitudes.filter(i=>i.id!==e.id)}})}irPerfil(e){this.router.navigate(["/",e])}static{this.\u0275fac=function(i){return new(i||t)(g(Se),g(V),g(N))}}static{this.\u0275cmp=v({type:t,selectors:[["app-solicitudes"]],decls:7,vars:3,consts:[[1,"component-container"],[1,"titulo"],[3,"mensaje"],[1,"solicitudes-container"],[1,"vacio"],[2,"cursor","pointer"],[2,"cursor","pointer",3,"click"],["type","button",1,"btn-aceptar",3,"click"],[1,"btn-icon"],["width","1em","height","1em","viewBox","0 0 20 20","fill","none","xmlns","http://www.w3.org/2000/svg",2,"vertical-align","middle"],["d","M5 10l3 3 7-7","stroke","#fff","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["type","button",3,"click"],["x1","6","y1","6","x2","14","y2","14","stroke","#fff","stroke-width","2","stroke-linecap","round"],["x1","14","y1","6","x2","6","y2","14","stroke","#fff","stroke-width","2","stroke-linecap","round"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"h2",1),c(2,"Solicitudes"),r(),f(3,Dn,1,1,"app-cargando",2),y(4,"async"),f(5,An,13,0,"div",3)(6,Rn,2,0,"p",4),r()),i&2&&(s(3),p(T(4,1,n.cargandoService.cargandoProlongado)?3:n.solicitudes.length>0?5:6))},dependencies:[k,H,we,$],styles:['.solicitudes-container[_ngcontent-%COMP%]{margin-top:18px;background:var(--surface-alt);border-radius:10px;box-shadow:0 2px 10px #0002;overflow-x:auto;padding:16px 0;scrollbar-width:none;-ms-overflow-style:none}.solicitudes-container[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.solicitudes-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;background:transparent;color:var(--text);font-size:1.22rem}.solicitudes-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .solicitudes-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:20px 18px;border-bottom:1px solid var(--border);text-align:left;vertical-align:middle}.solicitudes-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:var(--primary);font-weight:700;font-size:1.25rem;letter-spacing:1px;border-top:none}.solicitudes-container[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.solicitudes-container[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background var(--transition),box-shadow .18s cubic-bezier(.4,0,.2,1),transform .18s cubic-bezier(.4,0,.2,1);cursor:pointer;position:relative;z-index:1}.solicitudes-container[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#23231f;box-shadow:0 4px 18px #0003,0 1.5px #fff1 inset;transform:scale(1.012);border-radius:8px}.btn[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--danger) 0%,#ff5f5f 100%);color:#fff;border:1.5px solid #fff3;padding:12px 32px 12px 22px;border-radius:8px;font-size:1.18rem;font-weight:600;cursor:pointer;transition:background .2s cubic-bezier(.4,0,.2,1),box-shadow .2s cubic-bezier(.4,0,.2,1),transform .15s cubic-bezier(.4,0,.2,1);box-shadow:0 2px 8px #0001,0 1.5px #fff2 inset;margin-right:8px;display:inline-flex;align-items:center;gap:.5em;outline:none;position:relative;overflow:hidden}.btn[_ngcontent-%COMP%]:before, button[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(120deg,#fff2 10%,transparent 80%);opacity:.18;pointer-events:none}.btn[_ngcontent-%COMP%]:hover, .btn[_ngcontent-%COMP%]:focus-visible, button[_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]:focus-visible{background:linear-gradient(90deg,#ff5f5f 0%,var(--danger) 100%);box-shadow:0 4px 18px #ff1a1a33,0 2px #fff2 inset;transform:translateY(-2px) scale(1.03);border-color:#fff6}.btn[_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:active{background:linear-gradient(90deg,#e03c3c 0%,var(--danger) 100%);box-shadow:0 1px 4px #0002;transform:scale(.98)}.btn-aceptar[_ngcontent-%COMP%]{background:linear-gradient(90deg,var(--success) 0%,#4be37a 100%)}.btn-aceptar[_ngcontent-%COMP%]:hover, .btn-aceptar[_ngcontent-%COMP%]:focus-visible{background:linear-gradient(90deg,#4be37a 0%,var(--success) 100%);box-shadow:0 4px 18px #2ecc4033,0 2px #fff2 inset;border-color:#fff6}.btn-aceptar[_ngcontent-%COMP%]:active{background:linear-gradient(90deg,#27ae60 0%,var(--success) 100%);box-shadow:0 1px 4px #0002}.btn[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%], button[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{font-size:1.25em;margin-right:.5em;display:inline-flex;align-items:center;vertical-align:middle;opacity:.85}@media (max-width: 900px){.solicitudes-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .solicitudes-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:14px 8px;font-size:1.05rem}button[_ngcontent-%COMP%]{padding:10px 18px;font-size:1.05rem}}@media (max-width: 600px){.solicitudes-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .solicitudes-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 4px;font-size:.95rem}button[_ngcontent-%COMP%]{width:100%;padding:8px 10px;font-size:.9rem}button[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{margin-right:0}}']})}}return t})();var Qe=t=>["/",t],Je=(t,l)=>l.id;function Ln(t,l){if(t&1){let e=w();o(0,"input",4),S("ngModelChange",function(n){h(e);let a=m();return P(a.busqueda,n)||(a.busqueda=n),b(n)}),u("input",function(){h(e);let n=m();return b(n.filtrar())}),r()}if(t&2){let e=m();M("ngModel",e.busqueda)}}function Nn(t,l){if(t&1){let e=w();o(0,"tr")(1,"td")(2,"a",6),c(3),r()(),o(4,"td"),c(5),r(),o(6,"td")(7,"button",7),u("click",function(){let n=h(e).$implicit,a=m(4);return b(a.eliminarRelacion(n.id))}),c(8," Eliminar "),r()()()}if(t&2){let e=l.$implicit;s(2),_("routerLink",X(3,Qe,e.username)),s(),x(e.username),s(2),x(e.nombre)}}function Wn(t,l){if(t&1&&(o(0,"div",5)(1,"table")(2,"thead")(3,"tr")(4,"th"),c(5,"Usuario"),r(),o(6,"th"),c(7,"Nombre"),r(),C(8,"th"),r()(),o(9,"tbody"),F(10,Nn,9,5,"tr",null,Je),r()()()),t&2){let e=m(3);s(10),z(e.barberosFiltrados)}}function Un(t,l){t&1&&(o(0,"p",8),c(1,"Ning\xFAn barbero coincide con la b\xFAsqueda."),r())}function qn(t,l){t&1&&(o(0,"p",8),c(1,"A\xFAn no tienes relaciones."),r())}function Hn(t,l){if(t&1&&f(0,Un,2,0,"p",8)(1,qn,2,0,"p",8),t&2){let e=m(3);p(e.barberos.length>0?0:1)}}function Gn(t,l){if(t&1&&f(0,Wn,12,0,"div",5)(1,Hn,2,1),t&2){let e=m(2);p(e.barberosFiltrados.length>0?0:1)}}function $n(t,l){t&1&&(o(0,"p"),c(1,"A\xFAn no tienes relaciones."),r())}function Yn(t,l){if(t&1){let e=w();o(0,"tr")(1,"td")(2,"a",6),c(3),r()(),o(4,"td"),c(5),r(),o(6,"td")(7,"button",7),u("click",function(){let n=h(e).$implicit,a=m(4);return b(a.eliminarRelacion(n.id))}),c(8," Eliminar "),r()()()}if(t&2){let e=l.$implicit;s(2),_("routerLink",X(3,Qe,e.username)),s(),x(e.username),s(2),x(e.nombre)}}function Qn(t,l){if(t&1&&(o(0,"h3"),c(1,"Clientes"),r(),o(2,"div",5)(3,"table")(4,"thead")(5,"tr")(6,"th"),c(7,"Usuario"),r(),o(8,"th"),c(9,"Nombre"),r(),C(10,"th"),r()(),o(11,"tbody"),F(12,Yn,9,5,"tr",null,Je),r()()()),t&2){let e=m(3);s(12),z(e.clientesFiltrados)}}function Jn(t,l){if(t&1){let e=w();o(0,"tr")(1,"td")(2,"a",6),c(3),r()(),o(4,"td"),c(5),r(),o(6,"td")(7,"button",7),u("click",function(){let n=h(e).$implicit,a=m(4);return b(a.eliminarRelacion(n.id))}),c(8," Eliminar "),r()()()}if(t&2){let e=l.$implicit;s(2),_("routerLink",X(3,Qe,e.username)),s(),x(e.username),s(2),x(e.nombre)}}function Zn(t,l){if(t&1&&(o(0,"h3"),c(1,"Barberos"),r(),o(2,"div",5)(3,"table")(4,"thead")(5,"tr")(6,"th"),c(7,"Usuario"),r(),o(8,"th"),c(9,"Nombre"),r(),C(10,"th"),r()(),o(11,"tbody"),F(12,Jn,9,5,"tr",null,Je),r()()()),t&2){let e=m(3);s(12),z(e.barberosFiltrados)}}function Xn(t,l){if(t&1&&(o(0,"p",8),c(1),r()),t&2){let e=m(3);s(),E('No se encontraron resultados para "',e.busqueda,'"')}}function Kn(t,l){if(t&1&&f(0,$n,2,0,"p")(1,Qn,14,0)(2,Zn,14,0)(3,Xn,2,1,"p",8),t&2){let e=m(2);p(e.clientes.length===0&&e.barberos.length===0?0:-1),s(),p(e.clientesFiltrados.length>0?1:-1),s(),p(e.barberosFiltrados.length>0?2:-1),s(),p(e.clientesFiltrados.length===0&&e.busqueda!==""?3:-1)}}function ei(t,l){if(t&1&&f(0,Gn,2,1)(1,Kn,4,4),t&2){let e=m();p(e.datosService.esCliente()?0:-1),s(),p(e.datosService.esBarbero()?1:-1)}}function ti(t,l){t&1&&C(0,"app-cargando",3),t&2&&_("mensaje","Cargando relaciones")}var Lt=(()=>{class t{constructor(e,i,n){this.relacionesService=e,this.datosService=i,this.cargandoService=n,this.barberos=[],this.barberosFiltrados=[],this.clientes=[],this.clientesFiltrados=[],this.busqueda=""}ngOnInit(){this.datosService.esCliente()?this.relacionesService.getRelacionesCliente().subscribe({next:e=>{this.barberos=e,this.barberosFiltrados=this.barberos}}):this.datosService.esBarbero()&&(this.relacionesService.getRelacionesBarbero().subscribe({next:e=>{this.clientes=e,this.clientesFiltrados=this.clientes}}),this.relacionesService.getRelacionesCliente().subscribe({next:e=>{this.barberos=e,this.barberosFiltrados=this.barberos}}))}eliminarRelacion(e){this.relacionesService.eliminarRelacion(e).subscribe({next:()=>{this.clientes=this.clientes.filter(i=>i.id!==e),this.barberos=this.barberos.filter(i=>i.id!==e)}})}filtrar(){this.barberosFiltrados=this.barberos.filter(e=>e.nombre.toLowerCase().includes(this.busqueda.toLowerCase())||e.username.toLowerCase().includes(this.busqueda.toLowerCase())),this.clientesFiltrados=this.clientes.filter(e=>e.nombre.toLowerCase().includes(this.busqueda.toLowerCase())||e.username.toLowerCase().includes(this.busqueda.toLowerCase()))}static{this.\u0275fac=function(i){return new(i||t)(g(Se),g(I),g(V))}}static{this.\u0275cmp=v({type:t,selectors:[["app-relaciones"]],decls:7,vars:5,consts:[[1,"component-container"],[1,"titulo"],["id","busqueda-relaciones","name","busqueda","type","text","placeholder","Filtrar por nombre o usuario","autocomplete","off","aria-label","Buscar relaciones",3,"ngModel"],[3,"mensaje"],["id","busqueda-relaciones","name","busqueda","type","text","placeholder","Filtrar por nombre o usuario","autocomplete","off","aria-label","Buscar relaciones",3,"ngModelChange","input","ngModel"],[1,"solicitudes-container"],[3,"routerLink"],["title","Eliminar relaci\xF3n",3,"click"],[1,"vacio"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"h2",1),c(2,"Tus relaciones"),r(),f(3,Ln,1,1,"input",2)(4,ei,2,2)(5,ti,1,1,"app-cargando",3),y(6,"async"),r()),i&2&&(s(3),p(n.barberos.length>0||n.clientes.length>0?3:-1),s(),p(n.cargandoService.cargando?-1:4),s(),p(T(6,3,n.cargandoService.cargandoProlongado)?5:-1))},dependencies:[De,U,D,B,A,R,k,H,$],styles:["input[type=text][_ngcontent-%COMP%]{width:25%;padding:12px 16px;margin-bottom:18px;border:1.5px solid var(--primary);background:var(--surface-alt);color:var(--text);border-radius:8px;font-size:1vw;transition:border-color var(--transition),box-shadow var(--transition);outline:none;box-shadow:0 1px 4px #0002}input[type=text][_ngcontent-%COMP%]:focus{border-color:var(--primary);box-shadow:0 2px 12px #daa52033;background:#23231f}.solicitudes-container[_ngcontent-%COMP%]{margin-top:10px;background:var(--surface-alt);border-radius:10px;box-shadow:0 2px 10px #0002;overflow-x:auto;padding:8px 0}.solicitudes-container[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;background:transparent;color:var(--text);font-size:1vw}.solicitudes-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .solicitudes-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1vw 2vw;border-bottom:1px solid var(--border);text-align:center;vertical-align:middle}.solicitudes-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{padding-right:1vw}.solicitudes-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:var(--surface);color:var(--primary);font-weight:700;font-size:1vw;letter-spacing:1px;border-top:none}.solicitudes-container[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.solicitudes-container[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background var(--transition)}.solicitudes-container[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#23231f}a[_ngcontent-%COMP%]{color:var(--primary);text-decoration:none;font-weight:600;transition:color var(--transition)}a[_ngcontent-%COMP%]:hover{color:var(--primary-dark);text-decoration:underline}button[_ngcontent-%COMP%]{background:var(--danger);color:#fff;border:none;padding:8px 18px;border-radius:6px;font-size:.9vw;font-weight:500;cursor:pointer;transition:background var(--transition),box-shadow var(--transition);box-shadow:0 1px 4px #0002}button[_ngcontent-%COMP%]:hover{background:var(--danger-hover);box-shadow:0 2px 8px #ff1a1a33}p[_ngcontent-%COMP%]{color:var(--text-muted);font-size:1.05vw;margin:10px 0}h3[_ngcontent-%COMP%]{font-size:1.5vw;margin:24px 0 10px;color:var(--primary);letter-spacing:1px}@media (max-width: 600px){input[type=text][_ngcontent-%COMP%]{width:60%;font-size:3vw}h3[_ngcontent-%COMP%]{font-size:7vw}.solicitudes-container[_ngcontent-%COMP%]{margin-top:0;padding:0;width:100%}.solicitudes-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{text-align:right}.solicitudes-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .solicitudes-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 6px;font-size:3vw}button[_ngcontent-%COMP%]{font-size:3vw}}"]})}}return t})();var ni=t=>["/",t,"mensajes"],ii=(t,l)=>l.username;function oi(t,l){t&1&&C(0,"app-cargando",2),t&2&&_("mensaje","Cargando productos")}function ri(t,l){if(t&1&&(o(0,"span",7),c(1),r()),t&2){let e=m().$implicit;s(),x(e.no_leidos)}}function ai(t,l){if(t&1&&(o(0,"li",3),C(1,"img",4),y(2,"uploads"),o(3,"div",5)(4,"span",6),c(5),f(6,ri,2,1,"span",7),r(),o(7,"span",8),c(8),r(),o(9,"span",9),c(10),y(11,"date"),y(12,"date"),r()()()),t&2){let e=l.$implicit,i=m(2);_("routerLink",X(15,ni,e.username)),s(),_("src",le(2,6,e.foto_perfil,"uploads"),L),s(4),E("",e.username," "),s(),p(e.no_leidos&&e.no_leidos>0?6:-1),s(2),x(e.ultimo_mensaje),s(2),E(" ",i.hoy(e.ultima_fecha)?le(11,9,e.ultima_fecha,"HH:mm"):le(12,12,e.ultima_fecha,"dd/MM")," ")}}function si(t,l){if(t&1&&(o(0,"ul"),F(1,ai,13,17,"li",3,ii),r()),t&2){let e=m();s(),z(e.chats)}}var Nt=(()=>{class t{constructor(e,i){this.mensajesService=e,this.cargandoService=i,this.chats=[],this.environment=Pe}ngOnInit(){this.mensajesService.cargarChats().subscribe(e=>{this.chats=e,this.cargandoService.ocultarCargando()})}hoy(e){let i=new Date(e),n=new Date;return i.toLocaleDateString()===n.toLocaleDateString()}static{this.\u0275fac=function(i){return new(i||t)(g(kt),g(V))}}static{this.\u0275cmp=v({type:t,selectors:[["app-chats"]],decls:6,vars:3,consts:[[1,"chats-container"],[1,"titulo"],[3,"mensaje"],[3,"routerLink"],["alt","Avatar",1,"avatar-barber",3,"src"],[1,"info-chat"],[1,"username-barber"],[1,"badge-noleidos"],[1,"ultimo-mensaje"],[1,"fecha"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"h2",1),c(2,"Chats"),r(),f(3,oi,1,1,"app-cargando",2),y(4,"async"),f(5,si,3,0,"ul"),r()),i&2&&(s(3),p(T(4,1,n.cargandoService.cargandoProlongado)?3:5))},dependencies:[k,H,we,U,G,$],styles:['ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0 auto;width:40vw;background:#181a20;border-radius:18px;box-shadow:0 4px 24px #0000002e;border:1px solid #23263a;overflow:hidden}li[_ngcontent-%COMP%], .chat-item[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;padding:1.4vw;box-sizing:border-box;background:transparent;border-bottom:1px solid #23263a;transition:background .2s;cursor:pointer}li[_ngcontent-%COMP%]:hover, .chat-item[_ngcontent-%COMP%]:hover{background:#23263a;box-shadow:0 2px 8px #4f8cff14;border-radius:0}.avatar-barber[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;border:2px solid #3a5be0;background:#23263a;object-fit:cover;margin-right:18px;box-shadow:0 0 0 3px #181a20}.info-chat[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;justify-content:center}.username-barber[_ngcontent-%COMP%]{font-size:1.1vw;font-weight:700;color:#3a5be0;letter-spacing:.5px;font-family:Inter,sans-serif;margin-bottom:2px;display:flex;align-items:center;justify-content:space-between}.ultimo-mensaje[_ngcontent-%COMP%]{font-size:.9vw;color:#e0e6f0;opacity:.85;margin-bottom:4px}.fecha[_ngcontent-%COMP%]{font-size:.9vw;color:#7a7e8a;align-self:flex-end}.chats-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:32px 0;background:#181a20}.badge-noleidos[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;background:linear-gradient(90deg,#ff5252,#d32f2f);color:#fff;font-size:.92em;font-weight:700;border-radius:50px;min-width:26px;height:22px;padding:0 9px;margin-left:auto;box-shadow:0 2px 8px #ff525233,0 1px #fff2 inset;border:1.5px solid #fff3;letter-spacing:.02em;transition:background .18s,box-shadow .18s;position:relative;top:-2px;z-index:2;animation:_ngcontent-%COMP%_badgePop .3s cubic-bezier(.4,0,.2,1)}.badge-noleidos[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;inset:2px;border-radius:50px;background:linear-gradient(120deg,#fff2 10%,transparent 80%);opacity:.13;pointer-events:none}.badge-noleidos[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#ff7979,#e53935);box-shadow:0 4px 16px #ff525244,0 2px #fff2 inset}@keyframes _ngcontent-%COMP%_badgePop{0%{transform:scale(.7);opacity:0}70%{transform:scale(1.15);opacity:1}to{transform:scale(1);opacity:1}}@media (max-width: 600px){ul[_ngcontent-%COMP%]{max-width:100vw;border-radius:0}.chat-item[_ngcontent-%COMP%]{padding:12px 6px}.avatar-barber[_ngcontent-%COMP%]{width:36px;height:36px}}']})}}return t})();function ci(t,l){if(t&1&&(o(0,"option",9),c(1),r()),t&2){let e=l.$implicit;_("value",e),s(),x(e)}}function li(t,l){if(t&1&&(o(0,"option",9),c(1),r()),t&2){let e=l.$implicit;_("value",e),s(),x(e)}}function di(t,l){if(t&1){let e=w();o(0,"tr")(1,"td"),c(2),r(),o(3,"td")(4,"input",6),S("ngModelChange",function(n){let a=h(e).$implicit;return P(a.abierto,n)||(a.abierto=n),b(n)}),r()(),o(5,"td")(6,"select",7),S("ngModelChange",function(n){let a=h(e).$implicit;return P(a.inicio,n)||(a.inicio=n),b(n)}),f(7,ci,2,2,"option",8),r()(),o(8,"td")(9,"select",7),S("ngModelChange",function(n){let a=h(e).$implicit;return P(a.fin,n)||(a.fin=n),b(n)}),f(10,li,2,2,"option",8),r()()()}if(t&2){let e=l.$implicit,i=l.index,n=m();s(2),x(n.dias[i]),s(2),M("ngModel",e.abierto),s(2),M("ngModel",e.inicio),_("disabled",!e.abierto),s(),_("ngForOf",n.horas),s(2),M("ngModel",e.fin),_("disabled",!e.abierto),s(),_("ngForOf",n.horas)}}function mi(t,l){if(t&1&&(o(0,"div",5),c(1),r()),t&2){let e=m();s(),x(e.mensaje)}}var Wt=["Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado","Domingo"],Ut=(()=>{class t{constructor(e,i){this.usuariosService=e,this.citasService=i,this.horario=Wt.map(()=>({abierto:!0,inicio:"09:00",fin:"17:00"})),this.dias=Wt,this.mensaje="",this.horas=Array.from({length:24*2},(n,a)=>{let d=Math.floor(a/2).toString().padStart(2,"0"),O=a%2===0?"00":"30";return`${d}:${O}`}),this.semanasFuturas=1,this.cargarHorario()}cargarHorario(){this.usuariosService.getHorarioBarbero().subscribe({next:e=>{e&&Array.isArray(e.horario)&&(this.horario=e.horario)}})}guardar(){if(!this.validarHorario()){this.mensaje="Revisa que las horas de inicio sean anteriores a las de fin y que no haya solapamientos.";return}this.usuariosService.setHorarioBarbero(this.horario).subscribe({next:()=>{this.mensaje="Patr\xF3n guardado correctamente"},error:()=>{this.mensaje="Error al guardar el patr\xF3n"}})}validarHorario(){for(let e of this.horario)if(e.abierto&&e.inicio>=e.fin)return!1;return!0}aplicarFuturo(){if(!this.validarHorario()){this.mensaje="Revisa que las horas de inicio sean anteriores a las de fin y que no haya solapamientos.";return}this.usuariosService.setHorarioBarbero(this.horario).subscribe({next:()=>{let e=new Date,i=new Date(e),n=i.getDay(),a=n===0?-6:1-n;i.setDate(i.getDate()+a+7);let d=new Date(i);d.setDate(i.getDate()+7*this.semanasFuturas-1),this.citasService.generarCitasSemana(i,d).subscribe({next:O=>{this.mensaje=`Patr\xF3n guardado y aplicado a las pr\xF3ximas ${this.semanasFuturas} semanas. Citas creadas: ${O.creadas}`},error:O=>{this.mensaje=O?.error?.error||"Error al aplicar el patr\xF3n a pr\xF3ximas semanas"}})},error:()=>{this.mensaje="Error al guardar el patr\xF3n antes de aplicar."}})}restablecerSemana(){if(!this.validarHorario()){this.mensaje="Revisa que las horas de inicio sean anteriores a las de fin y que no haya solapamientos.";return}this.usuariosService.setHorarioBarbero(this.horario).subscribe({next:()=>{let e=new Date,i=new Date(e),n=i.getDay(),a=n===0?-6:1-n;i.setDate(i.getDate()+a);let d=new Date(i);d.setDate(i.getDate()+6),this.citasService.generarCitasSemana(i,d).subscribe({next:O=>{this.mensaje=`Patr\xF3n guardado y semana restablecida al patr\xF3n. Citas creadas: ${O.creadas}`},error:O=>{this.mensaje=O?.error?.error||"Error al restablecer la semana actual"}})},error:()=>{this.mensaje="Error al guardar el patr\xF3n antes de restablecer."}})}static{this.\u0275fac=function(i){return new(i||t)(g(W),g(de))}}static{this.\u0275cmp=v({type:t,selectors:[["app-preferencias-horario-barbero"]],inputs:{horario:"horario"},decls:29,vars:3,consts:[[1,"preferencias-horario"],[4,"ngFor","ngForOf"],[1,"acciones-horario"],["type","button",3,"click"],["type","number","min","1",3,"ngModelChange","ngModel"],[1,"mensaje-horario"],["type","checkbox",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel","disabled"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,n){i&1&&(o(0,"h3"),c(1,"Preferencias"),r(),o(2,"div",0)(3,"h3"),c(4,"Horario semanal recurrente"),r(),o(5,"table")(6,"thead")(7,"tr")(8,"th"),c(9,"D\xEDa"),r(),o(10,"th"),c(11,"Abierto"),r(),o(12,"th"),c(13,"Hora inicio"),r(),o(14,"th"),c(15,"Hora fin"),r()()(),o(16,"tbody"),f(17,di,11,8,"tr",1),r()(),o(18,"div",2)(19,"button",3),u("click",function(){return n.guardar()}),c(20,"Guardar patr\xF3n"),r(),o(21,"button",3),u("click",function(){return n.restablecerSemana()}),c(22,"Aplicar a la semana actual"),r(),o(23,"button",3),u("click",function(){return n.aplicarFuturo()}),c(24,"Aplicar a pr\xF3ximas semanas"),r(),o(25,"label"),c(26,"Semanas futuras: "),o(27,"input",4),S("ngModelChange",function(d){return P(n.semanasFuturas,d)||(n.semanasFuturas=d),d}),r()()(),f(28,mi,2,1,"div",5),r()),i&2&&(s(17),_("ngForOf",n.horario),s(10),M("ngModel",n.semanasFuturas),s(),p(n.mensaje?28:-1))},dependencies:[k,Ve,D,wt,Mt,B,Ae,Be,vt,A,Re,R],styles:[".preferencias-horario[_ngcontent-%COMP%]{background:#23272f;border-radius:10px;padding:1.5em;color:#eaf0fa;box-shadow:0 2px 8px #00000014}.preferencias-horario[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1em}.preferencias-horario[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:1em}.preferencias-horario[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .preferencias-horario[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5em .7em;text-align:center}.preferencias-horario[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#2c3440}.preferencias-horario[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background:#262b33}.acciones-horario[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:1em;margin-bottom:.5em}.acciones-horario[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#4caf50;color:#fff;border:none;border-radius:5px;padding:.5em 1.2em;font-weight:700;cursor:pointer;transition:background .2s}.acciones-horario[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#388e3c}.mensaje-horario[_ngcontent-%COMP%]{color:#4caf50;margin-top:.5em}@media (max-width: 600px){.preferencias-horario[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{font-size:.9em}.acciones-horario[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr)}.acciones-horario[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.4em 1em;font-size:.9em}}"]})}}return t})();function pi(t,l){if(t&1&&(o(0,"span"),c(1),r()),t&2){let e=m(2);s(),x(e.mensajeVerificacion)}}function ui(t,l){if(t&1){let e=w();o(0,"div",17)(1,"span"),c(2,"Tu email no est\xE1 verificado."),r(),o(3,"span",28),c(4,"Verificar tu email es importante para poder recuperar tu cuenta, recibir notificaciones y garantizar la seguridad de tu perfil."),r(),o(5,"button",29),u("click",function(){h(e);let n=m();return b(n.reenviarVerificacionEmail())}),c(6,"Reenviar email de verificaci\xF3n"),r(),f(7,pi,2,1,"span"),r()}if(t&2){let e=m();s(5),_("disabled",e.reenviandoEmail),s(2),p(e.mensajeVerificacion?7:-1)}}function gi(t,l){t&1&&C(0,"app-preferencias-horario-barbero")}function fi(t,l){t&1&&(o(0,"div",24),c(1," Debes verificar tu cuenta para poder modificar esta opci\xF3n. "),r())}function _i(t,l){if(t&1&&(o(0,"div",34),c(1),r()),t&2){let e=m(2);s(),x(e.mensajeEliminacion)}}function Ci(t,l){if(t&1){let e=w();o(0,"div",27)(1,"div",30)(2,"h2"),c(3,"\xBFEst\xE1s seguro de que deseas eliminar tu cuenta?"),r(),o(4,"p"),c(5," Esta acci\xF3n es irreversible. Se eliminar\xE1n todos tus datos y no podr\xE1s recuperarlos. "),r(),o(6,"div",31)(7,"button",32),u("click",function(){h(e);let n=m();return b(n.confirmarEliminarCuenta())}),c(8,"Estoy seguro, eliminar cuenta"),r(),o(9,"button",33),u("click",function(){h(e);let n=m();return b(n.mostrarDialogoEliminar=!1)}),c(10,"Cancelar"),r()(),f(11,_i,2,1,"div",34),r()()}if(t&2){let e=m();s(11),p(e.mensajeEliminacion?11:-1)}}var qt=(()=>{class t{constructor(e,i,n,a,d){this.httpService=e,this.datosService=i,this.usuariosService=n,this.toastService=a,this.validacionesService=d,this.imagenSeleccionada=null,this.imagenUrl=null,this.username=this.datosService.user.username,this.reenviandoEmail=!1,this.mensajeVerificacion="",this.notificacionesEmail=this.datosService.user.enviar_emails??!0,this.mostrarDialogoEliminar=!1,this.mensajeEliminacion=""}activarInput(){let e=document.getElementById("fileInput");e?e.click():console.error('El elemento con id "fileInput" no se encontr\xF3.')}seleccionarImagen(e){this.imagenSeleccionada=e.target.files[0],this.subirImagen()}subirImagen(e){if(e?.preventDefault(),!this.imagenSeleccionada){this.toastService.error("Por favor, selecciona una imagen");return}let i=new FormData;i.append("imagen",this.imagenSeleccionada),this.httpService.putToken("/usuarios/imagen-perfil",i).subscribe({next:n=>{this.datosService.actualizar("foto_perfil",n.fotoPerfil),this.toastService.mostrar(n)},error:n=>{console.error("Error al subir la imagen:",n),this.toastService.error("Error al subir la imagen")}})}editar(e,i){return Oe(this,null,function*(){if(i.trim()){if(i=i.trim(),e==="email"){let n=this.validacionesService.validarEmail(i);if(n){this.toastService.error(n);return}}if(e==="username"){let n=this.validacionesService.validarUsername(i);if(n){this.toastService.error(n);return}try{let a=yield Fe(this.usuariosService.validarUsername(i));if(console.log(a),!a.valido){this.toastService.error("El nombre de usuario ya est\xE1 en uso");return}}catch(a){this.toastService.error(a);return}}this.httpService.putToken("/usuarios",{campo:e,valor:i}).subscribe({next:n=>{this.toastService.mostrar(n),this.datosService.actualizar(e,i)},error:n=>{this.toastService.error(n)}})}})}reenviarVerificacionEmail(){this.reenviandoEmail=!0,this.mensajeVerificacion="",this.usuariosService.enviarVerificacionEmail().subscribe({next:()=>{this.mensajeVerificacion="Email de verificaci\xF3n enviado. Revisa tu bandeja de entrada.",this.reenviandoEmail=!1},error:e=>{this.mensajeVerificacion=e?.error?.error||"Error al enviar el email de verificaci\xF3n.",this.reenviandoEmail=!1}})}toggleNotificacionesEmail(){this.notificacionesEmail=!this.notificacionesEmail,this.httpService.putToken("/usuarios",{campo:"enviar_emails",valor:this.notificacionesEmail}).subscribe({next:()=>{this.datosService.actualizar("enviar_emails",this.notificacionesEmail)},error:()=>{this.toastService.error("No se pudo actualizar la preferencia de notificaciones."),this.notificacionesEmail=!this.notificacionesEmail}})}cambiarTipoCuenta(){let e=this.datosService.user.rol==="barbero"?"cliente":"barbero";this.httpService.putToken("/usuarios",{campo:"barbero",valor:e==="barbero"}).subscribe({next:()=>{this.datosService.actualizar("rol",e),this.toastService.mostrar({mensaje:`Ahora eres ${e}.`})},error:()=>{this.toastService.error("No se pudo cambiar el tipo de cuenta.")}})}confirmarEliminarCuenta(){return Oe(this,null,function*(){if(this.mensajeEliminacion="",!this.datosService.user.email_verificado){try{yield Fe(this.httpService.deleteToken("/usuarios")),this.mensajeEliminacion="Cuenta eliminada correctamente."}catch{this.mensajeEliminacion="Error al eliminar la cuenta."}return}try{yield Fe(this.usuariosService.enviarConfirmacionEliminacion()),this.mensajeEliminacion="Te hemos enviado un correo para confirmar la eliminaci\xF3n de tu cuenta."}catch{this.mensajeEliminacion="No se pudo enviar el correo de confirmaci\xF3n."}})}static{this.\u0275fac=function(i){return new(i||t)(g(K),g(I),g(W),g(q),g(Le))}}static{this.\u0275cmp=v({type:t,selectors:[["app-editar-perfil"]],decls:50,vars:24,consts:[[1,"foto-perfil-container"],[3,"alt","src"],[1,"change-button-container"],[3,"click"],["id","uploadForm",3,"submit"],["type","file","id","fileInput",1,"file-input",3,"change"],["type","submit"],["for","nombre"],["type","text","id","nombre",3,"ngModelChange","change","ngModel"],["for","username"],["type","text","id","username","value","datosService.user.username",3,"ngModelChange","change","ngModel"],["for","email"],["type","email","id","email",3,"ngModelChange","change","ngModel"],["id","bio-container"],["for","bio"],["id","bio",3,"ngModelChange","change","ngModel"],[1,"opciones-cuenta"],[1,"email-warning"],["routerLink","/cambiar-password",1,"btn-opciones"],["src","svgs/icono-candado.svg","alt","Cambiar contrase\xF1a"],["id","notificaciones-container"],["type","button",1,"btn-opciones",3,"click"],["alt","Notificaciones por email",3,"src"],[1,"estado-notificacion"],[1,"mensaje-notificacion-disabled"],["src","svgs/icono-cambiar-cuenta.svg","alt","Cambiar tipo de cuenta"],["src","svgs/icono-papelera.svg","alt","Eliminar cuenta"],[1,"dialogo-eliminar-overlay"],[1,"email-info"],[3,"click","disabled"],[1,"dialogo-eliminar"],[1,"botones-eliminar"],[1,"btn-eliminar-definitivo",3,"click"],[1,"btn-cancelar",3,"click"],[1,"mensaje-eliminacion"]],template:function(i,n){i&1&&(o(0,"section")(1,"span",0),C(2,"img",1),y(3,"uploads"),o(4,"div",2)(5,"button",3),u("click",function(){return n.activarInput()}),c(6,"Cambiar Foto"),r()(),o(7,"form",4),u("submit",function(d){return n.subirImagen(d)}),o(8,"input",5),u("change",function(d){return n.seleccionarImagen(d)}),r(),o(9,"button",6),c(10,"Subir Imagen"),r()()(),o(11,"aside")(12,"div")(13,"label",7),c(14,"Nombre: "),r(),o(15,"input",8),S("ngModelChange",function(d){return P(n.datosService.user.nombre,d)||(n.datosService.user.nombre=d),d}),u("change",function(){return n.editar("nombre",n.datosService.user.nombre)}),r()(),o(16,"div")(17,"label",9),c(18,"Username: "),r(),o(19,"input",10),S("ngModelChange",function(d){return P(n.username,d)||(n.username=d),d}),u("change",function(){return n.editar("username",n.username)}),r()(),o(20,"div")(21,"label",11),c(22,"Email: "),r(),o(23,"input",12),S("ngModelChange",function(d){return P(n.datosService.user.email,d)||(n.datosService.user.email=d),d}),u("change",function(){return n.editar("email",n.datosService.user.email)}),r()(),o(24,"div",13)(25,"label",14),c(26,"Bio: "),r(),o(27,"textarea",15),S("ngModelChange",function(d){return P(n.datosService.user.bio,d)||(n.datosService.user.bio=d),d}),u("change",function(){return n.editar("bio",n.datosService.user.bio)}),r()(),o(28,"div",16),f(29,ui,8,2,"div",17)(30,gi,1,0,"app-preferencias-horario-barbero"),o(31,"h3"),c(32,"Opciones de cuenta"),r(),o(33,"a",18),C(34,"img",19),c(35," Cambiar contrase\xF1a "),r(),o(36,"div",20)(37,"button",21),u("click",function(){return n.datosService.user.email_verificado&&n.toggleNotificacionesEmail()}),C(38,"img",22),c(39," Notificaciones por email "),o(40,"span",23),c(41),r()(),f(42,fi,2,0,"div",24),r(),o(43,"button",21),u("click",function(){return n.cambiarTipoCuenta()}),C(44,"img",25),c(45),r(),o(46,"button",21),u("click",function(){return n.mostrarDialogoEliminar=!0}),C(47,"img",26),c(48," Eliminar cuenta "),r()()()(),f(49,Ci,12,1,"div",27)),i&2&&(s(2),_("alt",n.datosService.user.username)("src",n.datosService.user.foto_perfil?T(3,22,n.datosService.user.foto_perfil):n.datosService.noFoto,L),s(13),M("ngModel",n.datosService.user.nombre),s(4),M("ngModel",n.username),s(4),M("ngModel",n.datosService.user.email),s(4),M("ngModel",n.datosService.user.bio),s(2),p(n.datosService.user.email&&n.datosService.user.email_verificado===!1?29:-1),s(),p(n.datosService.user.rol==="barbero"?30:-1),s(7),ce("btn-disabled",!n.datosService.user.email_verificado)("btn-activo",n.notificacionesEmail)("btn-inactivo",!n.notificacionesEmail),Ee("aria-disabled",!n.datosService.user.email_verificado)("tabindex",n.datosService.user.email_verificado?0:-1),s(),_("src",n.notificacionesEmail?"svgs/icono-ojo.svg":"svgs/icono-ojo-off.svg",L),s(2),_("@if(datosService.user.email_verificado)",void 0),s(),E(" ",n.notificacionesEmail?"(activadas)":"(desactivadas)"," "),s(),p(n.datosService.user.email_verificado?-1:42),s(3),E(" Cambiar cuenta a ",n.datosService.user.rol==="barbero"?"Cliente":"Barbero"," "),s(4),p(n.mostrarDialogoEliminar?49:-1))},dependencies:[k,G,D,ne,B,A,ee,R,te,U,Ut],styles:["section[_ngcontent-%COMP%]{padding:1vw 4vw;width:100%;display:flex;gap:8px;justify-content:left;box-sizing:border-box}.foto-perfil-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-shrink:0;overflow:hidden;border-radius:8px;background-color:#000;width:14vw;height:14vw}.foto-perfil-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%}aside[_ngcontent-%COMP%]{width:100%;padding:0 1vw;display:grid;gap:0 2vw;grid-template-columns:1fr 1fr;box-sizing:border-box}aside[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:4px}input[type=text][_ngcontent-%COMP%], input[type=email][_ngcontent-%COMP%]{width:100%;padding:8px;box-sizing:border-box;border-radius:8px;background-color:#23272f;color:#eaf0fa;border:none;font-size:14px}#bio-container[_ngcontent-%COMP%]{grid-column:span 2;width:100%}textarea[_ngcontent-%COMP%]{width:100%;height:100%;padding:8px;box-sizing:border-box;border-radius:8px;background-color:#23272f;color:#eaf0fa;border:none;font-size:14px;resize:none;font-family:inherit}h1[_ngcontent-%COMP%]{margin-top:.4vw;display:flex;align-items:center;gap:12px;font-size:24px;font-weight:700}h2[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:gray}.change-button-container[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);opacity:0;transition:opacity .3s ease}span[_ngcontent-%COMP%]   .change-button-container[_ngcontent-%COMP%]:hover{opacity:1}.file-input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]{display:none}.email-warning[_ngcontent-%COMP%]{width:80%;background:#f72c2c94;border:1px solid #d32f2f;color:#fff;padding:1em;border-radius:6px;font-weight:700;display:flex;flex-direction:column;gap:.5em;margin:1em auto}.email-warning[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#d32f2f;color:#fff;border:none;border-radius:4px;padding:.5em 1em;cursor:pointer;font-weight:700}.email-warning[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{background:#f8bbbc;color:#b71c1c;cursor:not-allowed}.cambiar-password-container[_ngcontent-%COMP%]{background:#f7f7f7;border:1px solid #e0e0e0;border-radius:8px;padding:2em 1.5em;margin:2em 0 1em;max-width:400px;box-shadow:0 2px 8px #0000000a}.cambiar-password-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#d32f2f;margin-bottom:1em;font-size:1.2em}.cambiar-password-container[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{margin-bottom:1em;display:flex;flex-direction:column}.cambiar-password-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.3em}.cambiar-password-container[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;padding:.5em;font-size:1em;background:#fff}.cambiar-password-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{background:#d32f2f;color:#fff;border:none;border-radius:4px;padding:.7em 1.5em;font-weight:700;cursor:pointer;margin-top:.5em;transition:background .2s}.cambiar-password-container[_ngcontent-%COMP%]   button[disabled][_ngcontent-%COMP%]{background:#f8bbbc;color:#b71c1c;cursor:not-allowed}.mensaje-password[_ngcontent-%COMP%]{color:#d32f2f;margin-top:.7em;font-size:1em;font-weight:500}.opciones-cuenta[_ngcontent-%COMP%]{grid-column:1 / span 2;margin-top:20px;border-top:1px solid #444;padding-top:15px}.opciones-cuenta[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1em;margin-bottom:12px;color:#eaf0fa}.btn-opciones[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:#2c3440;color:#eaf0fa;padding:10px 15px;border-radius:8px;text-decoration:none;transition:background-color .2s;margin-bottom:10px;border:1px solid #444;width:fit-content}.btn-opciones[_ngcontent-%COMP%]:hover{background-color:#3c4758}.btn-opciones[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:18px;margin-right:10px;filter:invert(1)}.btn-opciones.btn-disabled[_ngcontent-%COMP%]{opacity:.5;pointer-events:none;cursor:not-allowed}.btn-opciones.btn-activo[_ngcontent-%COMP%]{border-color:#4caf50;background:#263c2c}.btn-opciones.btn-inactivo[_ngcontent-%COMP%]{border-color:#d32f2f;background:#3c2c2c}.estado-notificacion[_ngcontent-%COMP%]{margin-left:10px;font-size:.95em;color:#b3b3b3}#notificaciones-container[_ngcontent-%COMP%]{flex-direction:row;align-items:center}.mensaje-notificacion-disabled[_ngcontent-%COMP%]{color:#d32f2f;font-size:.95em;margin:4px 0 10px 10px;width:max-content!important}.dialogo-eliminar-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000a6;z-index:9999;display:flex;align-items:center;justify-content:center}.dialogo-eliminar[_ngcontent-%COMP%]{background:#23272f;color:#eaf0fa;border-radius:12px;padding:2.5em 2em 2em;box-shadow:0 8px 32px #00000040;max-width:800px;width:90vw;text-align:center}.dialogo-eliminar[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:.7em;font-size:2.1em;font-weight:700;color:#ff5252;letter-spacing:.5px;text-shadow:0 2px 12px rgba(220,0,0,.18)}.dialogo-eliminar[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:2em;color:#b3b3b3;font-size:1.1em}.dialogo-eliminar[_ngcontent-%COMP%]   .btn-eliminar-definitivo[_ngcontent-%COMP%], .dialogo-eliminar[_ngcontent-%COMP%]   .btn-cancelar[_ngcontent-%COMP%]{margin:0 .5em}.dialogo-eliminar[_ngcontent-%COMP%]   .btn-eliminar-definitivo[_ngcontent-%COMP%], .dialogo-eliminar[_ngcontent-%COMP%]   .btn-cancelar[_ngcontent-%COMP%]{margin-bottom:.5em;margin-top:.5em}.dialogo-eliminar[_ngcontent-%COMP%]   .botones-eliminar[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;gap:1.5em;margin-bottom:.5em}.btn-eliminar-definitivo[_ngcontent-%COMP%]{background:#d32f2f;color:#fff;border:none;border-radius:6px;padding:.7em 1.5em;font-weight:700;cursor:pointer;margin-right:1em;transition:background .2s}.btn-eliminar-definitivo[_ngcontent-%COMP%]:hover{background:#b71c1c}.btn-cancelar[_ngcontent-%COMP%]{background:#444;color:#fff;border:none;border-radius:6px;padding:.7em 1.5em;font-weight:700;cursor:pointer;transition:background .2s}.btn-cancelar[_ngcontent-%COMP%]:hover{background:#222}.mensaje-eliminacion[_ngcontent-%COMP%]{margin-top:1em;color:#d32f2f;font-weight:500}@media (max-width: 600px){section[_ngcontent-%COMP%]{flex-direction:column;align-items:center}.foto-perfil-container[_ngcontent-%COMP%]{width:20vw;height:20vw}aside[_ngcontent-%COMP%]{grid-template-columns:1fr}h1[_ngcontent-%COMP%]{font-size:20px}input[type=text][_ngcontent-%COMP%], input[type=email][_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{font-size:14px}}"]})}}return t})();var Ht=(()=>{class t{transform(e,...i){return typeof e=="string"&&e.length>0?e.charAt(0).toUpperCase()+e.slice(1):e}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=rt({name:"capitalize",type:t,pure:!0})}}return t})();function hi(t,l){if(t&1){let e=w();o(0,"button",5),u("click",function(){h(e);let n=m().$implicit,a=m(3);return b(a.loadComponent(n))}),c(1),y(2,"capitalize"),r()}if(t&2){let e=m().$implicit;s(),E(" ",T(2,1,e)," ")}}function bi(t,l){if(t&1&&f(0,hi,3,3,"button"),t&2){let e=l.$implicit,i=m(3);p(i.user.username!=i.datosService.user.username||e!="mensajes"?0:-1)}}function xi(t,l){if(t&1&&(o(0,"div",2),F(1,bi,1,1,null,null,he),r()),t&2){let e=m(2);s(),z(e.getMapaComponentesEntries())}}function vi(t,l){if(t&1){let e=w();o(0,"button",5),u("click",function(){h(e);let n=m(3);return b(n.solicitar(n.user.username))}),c(1,"Enviar solicitud"),r()}}function wi(t,l){t&1&&(o(0,"h3"),c(1,"Ya has enviado una solicitud, espera a que sea aceptada"),r())}function Mi(t,l){t&1&&(o(0,"h3"),c(1,"Tu solicitud ha sido rechazada"),r())}function Pi(t,l){if(t&1&&(o(0,"div",3)(1,"div",6)(2,"p"),c(3),r(),f(4,vi,2,0,"button")(5,wi,2,0,"h3")(6,Mi,2,0,"h3"),o(7,"a",7),c(8,"Volver a Inicio"),r()()()),t&2){let e=m(2);s(3),E("No tienes acceso al perfil de ",e.user.username,""),s(),p(e.relacionActual=="ninguna"?4:e.relacionActual=="pendiente"?5:e.relacionActual=="rechazado"?6:-1)}}function Si(t,l){t&1&&at(0)}function Oi(t,l){if(t&1&&(o(0,"section")(1,"span"),C(2,"img",1),y(3,"uploads"),r(),o(4,"aside")(5,"h1"),c(6),r(),o(7,"h2"),c(8),r(),o(9,"p"),c(10),r()(),f(11,xi,3,0,"div",2),r(),f(12,Pi,9,2,"div",3)(13,Si,1,0,"ng-container",4)),t&2){let e=m();s(2),_("alt",e.user.username)("src",T(3,8,e.user.foto_perfil)||e.datosService.noFoto,L),s(4),x(e.user.nombre),s(2),x("@"+e.user.username),s(2),x(e.user.bio),s(),p(e.usuarioAutorizado?11:-1),s(),p(e.usuarioAutorizado?-1:12),s(),_("ngComponentOutlet",e.component$.value)}}function yi(t,l){if(t&1&&C(0,"app-cargando",0),t&2){let e=m();_("mensaje",`Cargando perfil de ${e.user.username}`)}}var Gt=(()=>{class t{constructor(e,i,n,a,d){this.route=e,this.usuariosServices=i,this.datosService=n,this.relacionesService=a,this.cargandoService=d,this.user=ht,this.component$=new et(null),this.usuarioAutorizado=!1,this.relacionActual="",this.mapaComponentes={citas:()=>import("./chunk-7KQZGDBY.js").then(O=>O.ReservarCitasComponent),mensajes:()=>import("./chunk-FUBSK2F3.js").then(O=>O.MensajesComponent),productos:()=>import("./chunk-66AQ2EPS.js").then(O=>O.ProductosComponent)}}ngOnInit(){this.route.params.subscribe({next:e=>{this.user.username=e.username,this.usuariosServices.datosUsername(this.user.username).subscribe({next:i=>{this.user=i.user,this.user.username==this.datosService.user.username?(this.usuarioAutorizado=!0,this.loadComponent("citas")):this.relacionesService.comprobarRelacion(this.user.id).subscribe({next:n=>{this.usuarioAutorizado=n.relacion=="aceptado",this.relacionActual=n.relacion,this.usuarioAutorizado&&this.loadComponent("citas")}})}})}})}loadComponent(e){return Oe(this,null,function*(){let i=yield this.mapaComponentes[e]();this.component$.next(i)})}getMapaComponentesEntries(){return Object.keys(this.mapaComponentes)}solicitar(e){this.relacionesService.solicitar(e).subscribe({next:()=>{this.relacionActual="pendiente"},error:i=>{console.error("Error al solicitar relaci\xF3n:",i)}})}static{this.\u0275fac=function(i){return new(i||t)(g(Me),g(W),g(I),g(Se),g(V))}}static{this.\u0275cmp=v({type:t,selectors:[["app-perfil"]],decls:3,vars:4,consts:[[3,"mensaje"],[3,"alt","src"],[1,"perfil-botones"],[1,"overlay"],[4,"ngComponentOutlet"],[3,"click"],[1,"reserva-dialogo"],["routerLink","/"]],template:function(i,n){i&1&&(f(0,Oi,14,10)(1,yi,1,1,"app-cargando",0),y(2,"async")),i&2&&(p(n.cargandoService.cargando?-1:0),s(),p(T(2,2,n.cargandoService.cargandoProlongado)?1:-1))},dependencies:[De,U,dt,Ht,G,k,H,$],styles:["section[_ngcontent-%COMP%]{position:relative;margin:1vw 4vw;width:100%;display:flex;gap:8px;justify-content:left;flex:1}span[_ngcontent-%COMP%]{position:relative;display:flex;flex-shrink:0;overflow:hidden;border-radius:5px;background-color:#000;width:14vw;height:14vw}span[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;width:100%;height:100%}aside[_ngcontent-%COMP%]{margin-left:1vw}h1[_ngcontent-%COMP%]{margin-top:.4vw;margin-bottom:.2vw;display:flex;align-items:center;gap:12px;font-size:24px;font-weight:700}h2[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin:.4vw 0;color:gray}.perfil-botones[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;width:100%;display:flex;justify-content:center;gap:16px}.perfil-botones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#2196f3;font-size:1vw;font-weight:600;padding:10px 24px;cursor:pointer;transition:color .2s;border-radius:6px}.perfil-botones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 2px #2196f34d}.perfil-botones[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#1565c0;background:#2196f314}.overlay[_ngcontent-%COMP%]{margin-top:3rem;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.reserva-dialogo[_ngcontent-%COMP%]{background-color:var(--color-principal);padding:20px;border-radius:8px;box-shadow:0 4px 10px #00000040;text-align:center;z-index:1001}.reserva-dialogo[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:2em;margin-bottom:20px}.reserva-dialogo[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 10px;padding:10px 20px;border:none;border-radius:4px;cursor:pointer}.reserva-dialogo[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{background-color:#4caf50;color:#fff}.reserva-dialogo[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{background-color:#f44336;color:#fff}@media (max-width: 600px){section[_ngcontent-%COMP%]{margin-bottom:6vw;width:auto}.perfil-botones[_ngcontent-%COMP%]{bottom:-7vw}}"]})}}return t})();var $t=(t,l)=>{let e=Y(W),i=Y(N),n=t.params.username;return e.datosUsername(n).pipe(tt(a=>a.exists?!0:i.createUrlTree(["/"])))};var Yt=(()=>{class t{constructor(e){this.datosService=e}static{this.\u0275fac=function(i){return new(i||t)(g(I))}}static{this.\u0275cmp=v({type:t,selectors:[["pagina-principal-card"]],inputs:{barbero:"barbero"},decls:8,vars:6,consts:[[1,"card"],[1,"imagen-container"],[1,"card-img-top",3,"src","alt"],[1,"heading"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"div",1),C(2,"img",2),y(3,"uploads"),r(),o(4,"p",3),c(5),r(),o(6,"p"),c(7),r()()),i&2&&(s(2),J("alt",n.barbero.nombre),_("src",T(3,4,n.barbero.foto_perfil)||n.datosService.noFoto,L),s(3),x(n.barbero.nombre),s(2),x("@"+n.barbero.username))},dependencies:[G],styles:['.card[_ngcontent-%COMP%]{position:relative;box-sizing:border-box;width:11.8vw;height:15.5vw;background-color:#000;display:flex;flex-direction:column;justify-content:end;padding:.6vw;gap:.4vw;border-radius:8px;cursor:pointer;color:#fff}.card[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0 0 0 -5px;margin:auto;width:12.5vw;height:16.56vw;border-radius:10px;background:linear-gradient(-45deg,var(--primary) 0%,#ff4141 100%);z-index:-1;pointer-events:none;transition:all .6s cubic-bezier(.175,.885,.32,1.275)}.card[_ngcontent-%COMP%]:after{content:"";z-index:-1;position:absolute;inset:0;background:linear-gradient(-45deg,var(--primary) 0%,#ff7878 100%);transform:translateZ(0) scale(1);filter:blur(50px)}.imagen-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:100%;overflow:hidden}img[_ngcontent-%COMP%]{height:10vw;width:10vw;object-fit:contain;border-radius:4px}.heading[_ngcontent-%COMP%]{font-size:1.2vw;text-transform:capitalize;font-weight:700;margin:0}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{font-size:14px;color:#ffb01c;font-weight:600}.card[_ngcontent-%COMP%]:hover:after{filter:blur(30px)}.card[_ngcontent-%COMP%]:hover:before{transform:rotate(-90deg) scaleX(1.34) scaleY(.77)}@media (max-width: 600px){.card[_ngcontent-%COMP%]{width:40vw;height:52.56vw;min-width:110px;max-width:95vw;padding:6px;gap:8px;margin:1vw}.card[_ngcontent-%COMP%]:before{width:42vw;height:55.188vw;left:-1vw;border-radius:10px}.heading[_ngcontent-%COMP%]{font-size:16px}.card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{font-size:12px}img[_ngcontent-%COMP%]{height:100%;width:100%}}']})}}return t})();var He=(()=>{class t{constructor(e,i,n){this.router=e,this.usuariosService=i,this.cargandoService=n,this.buscarSubject=new ye,this.randomSubject=new ye,this.resultados=[],this.resultadosAleatorios=[],this.buscador="",this.buscadorCopia="",this.buscarSubject.pipe(ze(300),Ge(a=>this.usuariosService.buscarUsuarios(a))).subscribe(a=>{if(this.buscador==""){n.cargando=!1;return}this.resultados=a,this.buscadorCopia=this.buscador,this.cargandoService.cargando=!1}),this.randomSubject.pipe(Ge(()=>this.usuariosService.getRandomUsuarios())).subscribe(a=>{this.resultadosAleatorios=a,this.resultados=a,this.cargandoService.cargando=!1})}buscarUsuarios(){if(this.buscador=this.buscador.trim(),this.buscador.length===0){this.limpiarResultados();return}this.buscarSubject.next(this.buscador)}getRandomUsuarios(){this.randomSubject.next()}seleccionarUsuario(e){console.log(e),this.router.navigate([e]),this.limpiarResultados(),this.limpiarBuscador()}seleccionarPrimero(){this.resultados.length>0&&this.seleccionarUsuario(this.resultados[0].username)}limpiarResultados(){this.resultados.splice(0,this.resultados.length)}limpiarBuscador(){this.buscador=""}static{this.\u0275fac=function(i){return new(i||t)(se(N),se(W),se(V))}}static{this.\u0275prov=_e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var ki=(t,l)=>l.username;function Ei(t,l){t&1&&C(0,"app-cargando",6),t&2&&_("mensaje","Cargando barberos")}function Ti(t,l){if(t&1&&(o(0,"h2"),c(1),r()),t&2){let e=m();s(),E('Ningun usuario coincide con "',e.buscadorService.buscadorCopia,'"')}}function ji(t,l){if(t&1){let e=w();o(0,"pagina-principal-card",8),u("click",function(){let n=h(e).$implicit,a=m(2);return b(a.buscadorService.seleccionarUsuario(n.username))}),r()}if(t&2){let e=l.$implicit;_("barbero",e)}}function Fi(t,l){if(t&1&&F(0,ji,1,1,"pagina-principal-card",7,ki),t&2){let e=m();z(e.buscadorService.resultados)}}var Jt=(()=>{class t{constructor(e,i,n){this.buscadorService=e,this.cargandoService=i,this.usuariosService=n}ngOnInit(){this.buscadorService.getRandomUsuarios()}ngOnDestroy(){this.buscadorService.limpiarBuscador(),this.buscadorService.limpiarResultados()}inputLetra(){this.buscadorService.buscador==this.buscadorService.buscador.trim()&&(this.buscadorService.buscador=this.buscadorService.buscador.trim(),this.buscadorService.buscador.length==0?this.buscadorService.resultados=this.buscadorService.resultadosAleatorios:this.buscadorService.buscarUsuarios())}static{this.\u0275fac=function(i){return new(i||t)(g(He),g(V),g(W))}}static{this.\u0275cmp=v({type:t,selectors:[["app-pagina-principal"]],decls:12,vars:4,consts:[[1,"container"],[1,"fondo"],[1,"form-control"],["type","text","placeholder","Buscar barberos...",1,"input",3,"input","ngModelChange","ngModel"],[1,"main"],[1,"cards"],[3,"mensaje"],[3,"barbero"],[3,"click","barbero"]],template:function(i,n){i&1&&(o(0,"div",0),C(1,"div",1),o(2,"h1"),c(3,"Encuentra nuevos Barberos"),r(),o(4,"div",2)(5,"input",3),u("input",function(){return n.inputLetra()}),S("ngModelChange",function(d){return P(n.buscadorService.buscador,d)||(n.buscadorService.buscador=d),d}),r()(),o(6,"div",4)(7,"div",5),f(8,Ei,1,1,"app-cargando",6),y(9,"async"),f(10,Ti,2,1,"h2")(11,Fi,2,0),r()()()),i&2&&(s(5),M("ngModel",n.buscadorService.buscador),s(3),p(T(9,2,n.cargandoService.cargandoProlongado)?8:n.buscadorService.resultados.length==0&&!n.cargandoService.cargando?10:11))},dependencies:[D,B,A,R,Yt,k,H,$],styles:['.container[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-direction:column;align-items:center;height:100%}.fondo[_ngcontent-%COMP%]{top:0;position:absolute;width:100%;height:100%;opacity:.7;z-index:-1;background:linear-gradient(#242d3f,#88191933);filter:blur(200px)}h1[_ngcontent-%COMP%]{font-family:Montserrat,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";font-size:4vw}.form-control[_ngcontent-%COMP%]{width:20vw}.input[_ngcontent-%COMP%]{width:100%;height:3rem;font-family:inherit;font-size:1vw;background-color:#fff;color:#000;height:2.5vw;padding:12px;border-radius:12px;border:1.5px solid lightgrey;box-sizing:border-box;outline:none;transition:all .3s cubic-bezier(.19,1,.22,1);box-shadow:0 0 20px -18px}.input[_ngcontent-%COMP%]:hover{border:2px solid lightgrey;box-shadow:0 0 20px -17px}.input[_ngcontent-%COMP%]:active{transform:scale(.95)}.input[_ngcontent-%COMP%]:focus{border:2px solid grey}.main[_ngcontent-%COMP%]{width:100%;display:flex;position:relative;justify-content:center;align-items:center}.cards[_ngcontent-%COMP%]{width:90%;margin-top:5vh;display:flex;justify-content:center;flex-wrap:wrap;gap:2.4vw;padding:20px 0}@media (max-width: 600px){.container[_ngcontent-%COMP%]{width:100%;min-width:0}.main[_ngcontent-%COMP%]{width:auto;flex-direction:column;align-items:stretch;padding:0 .5em;gap:2em}.cards[_ngcontent-%COMP%]{margin-top:2vh;width:100%;padding:0}.card-row[_ngcontent-%COMP%]{width:100%;flex-direction:row;gap:2vw;padding:0 0 18px;align-items:stretch}h1[_ngcontent-%COMP%]{font-size:2.1rem;text-align:center;margin:.2em 0 .7em}.form-control[_ngcontent-%COMP%]{width:70%;min-width:0;margin-bottom:1em}.input[_ngcontent-%COMP%]{height:2rem;font-size:.8em;padding:10px;border-radius:8px}}']})}}return t})();var zi=["fileInput"],Ii=(t,l)=>({down:t,left:l}),Ze=(t,l)=>l.field,Vi=(t,l)=>l.id,Di=(t,l)=>l.username;function Bi(t,l){t&1&&C(0,"div",1)}function Ai(t,l){if(t&1){let e=w();o(0,"input",13),S("ngModelChange",function(n){h(e);let a=m().$implicit,d=m();return P(d.producto[a.field],n)||(d.producto[a.field]=n),b(n)}),r()}if(t&2){let e=m().$implicit,i=m();J("type",e.type),J("id",e.field),J("name",e.field),M("ngModel",i.producto[e.field])}}function Ri(t,l){if(t&1){let e=w();o(0,"textarea",14),S("ngModelChange",function(n){h(e);let a=m().$implicit,d=m();return P(d.producto[a.field],n)||(d.producto[a.field]=n),b(n)}),r()}if(t&2){let e=m().$implicit,i=m();J("id",e.field),J("name",e.field),M("ngModel",i.producto[e.field])}}function Li(t,l){if(t&1&&(o(0,"label",10),c(1),r(),f(2,Ai,1,4,"input",11)(3,Ri,1,3,"textarea",12)),t&2){let e=l.$implicit;J("for",e.field),s(),E(" ",e.label," "),s(),p(e.field!=="descripcion"?2:3)}}function Ni(t,l){if(t&1){let e=w();o(0,"div",7),C(1,"img",15),o(2,"button",16),u("click",function(n){h(e);let a=m();return b(a.eliminarImagen(n))}),c(3,"Eliminar Imagen"),r()()}if(t&2){let e=m();s(),_("src",e.urlImagen(),L)}}function Wi(t,l){t&1&&C(0,"app-cargando",9),t&2&&_("mensaje","Cargando productos")}function Ui(t,l){if(t&1&&(o(0,"div"),c(1),r()),t&2){let e=l.$implicit;Te("col ",e.colClass,""),s(),E(" ",e.label," ")}}function qi(t,l){if(t&1&&c(0),t&2){let e=m().$implicit,i=m().$implicit;E(" ",i[e.field]," ")}}function Hi(t,l){if(t&1){let e=w();o(0,"textarea",31),S("ngModelChange",function(n){h(e);let a=m(2).$implicit,d=m().$implicit;return P(d[a.field],n)||(d[a.field]=n),b(n)}),u("blur",function(){h(e);let n=m(5);return b(n.finishEditCell())}),r()}if(t&2){let e=m(2).$implicit,i=m().$implicit;$e("id","input-",i.id,"-",e.field,""),M("ngModel",i[e.field])}}function Gi(t,l){if(t&1){let e=w();o(0,"input",32),S("ngModelChange",function(n){h(e);let a=m(2).$implicit,d=m().$implicit;return P(d[a.field],n)||(d[a.field]=n),b(n)}),u("blur",function(){h(e);let n=m(5);return b(n.finishEditCell())}),r()}if(t&2){let e=m(2).$implicit,i=m().$implicit;$e("id","input-",i.id,"-",e.field,""),J("type",e.type),M("ngModel",i[e.field])}}function $i(t,l){if(t&1&&f(0,Hi,1,4,"textarea",29)(1,Gi,1,5,"input",30),t&2){let e=m().$implicit;p(e.field==="descripcion"?0:1)}}function Yi(t,l){if(t&1){let e=w();o(0,"div",28),u("dblclick",function(){let n=h(e).$implicit,a=m().$implicit,d=m(2);return b(d.editCell(a,n.field))}),f(1,qi,1,1)(2,$i,2,1),r()}if(t&2){let e=l.$implicit,i=m().$implicit,n=m(2);Te("col ",e.colClass,""),s(),p((n.editingCell==null?null:n.editingCell.id)!==i.id||(n.editingCell==null?null:n.editingCell.field)!==e.field?1:2)}}function Qi(t,l){if(t&1){let e=w();o(0,"input",33),u("change",function(n){h(e);let a=m(3);return b(a.seleccionarCambioImagen(n))}),r()}if(t&2){let e=m().$implicit;st("id","input-",e.id,"-foto")}}function Ji(t,l){if(t&1&&(C(0,"img",26),y(1,"uploads")),t&2){let e=m().$implicit;J("alt",e.nombre),_("src",T(1,2,e.foto),L)}}function Zi(t,l){t&1&&(o(0,"p"),c(1,"Sin imagen"),r())}function Xi(t,l){t&1&&(o(0,"li",17)(1,"div",34),c(2,"Usuario"),r(),o(3,"div",35),c(4,"Cantidad"),r()())}function Ki(t,l){t&1&&(o(0,"li",20)(1,"div",36),c(2,"No hay reservas para este producto"),r()())}function eo(t,l){if(t&1){let e=w();o(0,"li",20)(1,"div",34),c(2),r(),o(3,"div",35),c(4),r(),o(5,"div",37)(6,"button",38),u("click",function(){let n=h(e).$implicit,a=m(2).$implicit,d=m(2);return b(d.marcarEntregado(a.id,a.nombre,n.username))}),c(7,"Marcar como entregado"),r()()()}if(t&2){let e=l.$implicit;s(2),x(e.username),s(2),x(e.cantidad)}}function to(t,l){if(t&1&&(o(0,"ul",27),f(1,Xi,5,0,"li",17)(2,Ki,3,0,"li",20),F(3,eo,8,2,"li",20,Di),r()),t&2){let e=m().$implicit,i=m(2);s(),p(i.reservados[e.id]?1:-1),s(),p(i.reservados[e.id].length==0?2:-1),s(),z(i.reservados[e.id])}}function no(t,l){if(t&1){let e=w();o(0,"li",20)(1,"div",21)(2,"span",22),u("click",function(){let n=h(e).$implicit,a=m(2);return b(a.expandir(n))}),C(3,"i",23),r()(),F(4,Yi,3,4,"div",18,Ze),o(6,"div",24),u("dblclick",function(){let n=h(e).$implicit,a=m(2);return b(a.editCell(n,"foto"))}),f(7,Qi,1,2,"input",25)(8,Ji,2,4,"img",26)(9,Zi,2,0,"p"),r()(),f(10,to,5,2,"ul",27)}if(t&2){let e=l.$implicit,i=m(2);s(3),_("ngClass",ct(3,Ii,i.expandidos.includes(e.id),!i.expandidos.includes(e.id))),s(),z(i.campos),s(3),p((i.editingCell==null?null:i.editingCell.id)==e.id&&(i.editingCell==null?null:i.editingCell.field)=="foto"?7:e.foto?8:9),s(3),p(i.expandidos.includes(e.id)?10:-1)}}function io(t,l){if(t&1&&(o(0,"ul")(1,"li",17),F(2,Ui,2,4,"div",18,Ze),o(4,"div",19),c(5,"Imagen"),r()(),F(6,no,11,6,null,null,Vi),r()),t&2){let e=m();s(2),z(e.campos),s(4),z(e.productos)}}var Zt=(()=>{class t{constructor(e,i,n,a){this.httpService=e,this.datosService=i,this.cargandoService=n,this.toastService=a,this.producto={nombre:"",descripcion:"",precio:0,stock:0,foto:null},this.pantallaSubject=new ye,this.productos=[],this.expandidos=[],this.reservados={},this.campos=[{field:"nombre",label:"Nombre",type:"text",colClass:"col-1"},{field:"descripcion",label:"Descripci\xF3n",type:"text",colClass:"col-2"},{field:"precio",label:"Precio",type:"number",colClass:"col-3"},{field:"stock",label:"Stock",type:"number",colClass:"col-4"}],this.editingCell=null,this.oscurecerPantalla=!1,this.arrastrando=!1,this.pantallaSubject.pipe(ze(30)).subscribe(d=>{this.oscurecerPantalla=d,console.log(d)})}ngOnInit(){this.httpService.getToken(`/productos/barbero/${this.datosService.user.username}`).subscribe({next:e=>{this.productos=e,this.httpService.getToken("/productos/reservados").subscribe({next:i=>{this.reservados=i||{};for(let n of this.productos)Array.isArray(this.reservados[n.id])||(this.reservados[n.id]=[])},error:i=>{console.error("Error al obtener los productos reservados:",i),this.reservados={}}})},error:e=>{console.error("Error al obtener los productos:",e)}}).add(()=>{this.cargandoService.cargando=!1})}urlImagen(){return URL.createObjectURL(this.producto.foto)}seleccionarImagen(e){let i=e.target.files[0];if(i){let n=i.name.split(".").pop()?.toLowerCase();if(!["jpg","jpeg","png"].includes(n||"")){this.toastService.error({mensaje:"Solo se permiten im\xE1genes JPG o PNG",sugerencia:"Selecciona una imagen en formato .jpg, .jpeg o .png."},5e3),this.producto.foto=null,e.target.value="";return}this.producto.foto=i}}seleccionarCambioImagen(e){e.preventDefault();let i=e.target.files[0],n=new FormData;n.append("foto",i),this.httpService.putToken(`/productos/${this.editingCell?.id}`,n).subscribe({next:a=>{if(a.foto_url){let d=this.productos.find(O=>O.id===this.editingCell.id);d&&(d.foto=a.foto_url)}this.editingCell=null},error:a=>{console.error("Error al actualizar el producto:",a)}}).add(()=>{this.cargandoService.cargando=!1})}eliminarImagen(e){e.preventDefault(),this.producto.foto=null;let i=this.fileInput.nativeElement;i&&(i.value="")}handleDragOver(e){e.preventDefault(),this.arrastrando||(this.arrastrando=!0,this.pantallaSubject.next(!0))}handleDrop(e){if(e.preventDefault(),this.arrastrando=!1,this.pantallaSubject.next(!1),e.dataTransfer&&e.dataTransfer.files.length>0){let i=e.dataTransfer.files[0],n=i.name.split(".").pop()?.toLowerCase();if(!["jpg","jpeg","png"].includes(n||"")){this.toastService.error({mensaje:"Solo se permiten im\xE1genes JPG o PNG",sugerencia:"Selecciona una imagen en formato .jpg, .jpeg o .png."});return}this.producto.foto=i,e.dataTransfer.clearData()}}onDragLeave(e){e.preventDefault(),this.arrastrando=!1,this.pantallaSubject.next(!1)}subirProducto(){let e=new FormData;e.append("nombre",this.producto.nombre),e.append("descripcion",this.producto.descripcion),e.append("precio",this.producto.precio.toString()),e.append("stock",this.producto.stock.toString()),this.producto.foto&&e.append("foto",this.producto.foto),this.httpService.postToken("/productos",e).subscribe({next:i=>{this.toastService.mostrar(i)},error:i=>{this.toastService.error("Error al subir el producto: "+i.message)}}).add(()=>{this.cargandoService.cargando=!1}),console.log("Producto subido:",this.producto)}editCell(e,i){this.editingCell={id:e.id,field:i},setTimeout(()=>{let n=document.getElementById(`input-${e.id}-${i}`);n&&n.focus()},0)}finishEditCell(){if(this.editingCell){let{id:e,field:i}=this.editingCell,n=this.productos.find(a=>a.id===e);if(n){let a=document.getElementById(`input-${e}-${i}`);a&&(n[i]=a.value,this.httpService.putToken(`/productos/${e}`,{[i]:n[i]},!0).subscribe(()=>{},d=>{console.error("Error al actualizar el producto:",d)}))}}this.editingCell=null}expandir(e){let i=this.expandidos.indexOf(e.id);i===-1?this.expandidos.push(e.id):this.expandidos.splice(i,1)}marcarEntregado(e,i,n){this.toastService.preguntar(`\xBFMarcar ${i} como entregado para ${n}?`,()=>{this.httpService.postToken("/productos/marcar-entregado",{producto_id:e,username:n},!0).subscribe({next:a=>{this.reservados[e]&&(this.reservados[e]=this.reservados[e].filter(d=>d.username!==n)),this.cargandoService.cargando=!1,this.toastService.mostrar(a)},error:a=>{this.toastService.error(a)}})})}static{this.\u0275fac=function(i){return new(i||t)(g(K),g(I),g(V),g(q))}}static{this.\u0275cmp=v({type:t,selectors:[["app-mis-productos"]],viewQuery:function(i,n){if(i&1&&be(zi,5),i&2){let a;xe(a=ve())&&(n.fileInput=a.first)}},hostBindings:function(i,n){i&1&&u("drop",function(d){return n.handleDrop(d)})("dragover",function(d){return n.handleDragOver(d)})("dragleave",function(d){return n.onDragLeave(d)})},decls:17,vars:6,consts:[["fileInput",""],[1,"pantalla-oscura",2,"position","fixed","top","0","left","0","width","100vw","height","100vh","z-index","999","background","rgba(0,0,0,0.5)","pointer-events","none","transition","background 0.3s"],["id","uploadForm",3,"submit"],[1,"titulo"],[1,"upload-area"],["for","fileInput",1,"custom-file-upload"],["type","file","id","fileInput",1,"file-input",2,"display","none",3,"change"],[1,"preview-container"],["type","submit"],[3,"mensaje"],[3,"for"],["required","",3,"type","id","ngModel","name"],["required","",3,"id","ngModel","name"],["required","",3,"ngModelChange","type","id","ngModel","name"],["required","",3,"ngModelChange","id","ngModel","name"],["alt","Imagen del producto",1,"preview-image",3,"src"],[1,"remove-button",3,"click"],[1,"header"],[3,"class"],[1,"col","col-5"],[1,"row"],[1,"toggle-container",2,"display","inline-block","margin-right","8px"],[1,"toggle-button",3,"click"],[1,"triangle",3,"ngClass"],[1,"col","col-5",3,"dblclick"],["type","file",3,"id"],[3,"src","alt"],[1,"reservados-list",2,"animation","fadeIn 0.3s"],[3,"dblclick"],[3,"id","ngModel"],[3,"id","type","ngModel"],[3,"ngModelChange","blur","id","ngModel"],[3,"ngModelChange","blur","id","type","ngModel"],["type","file",3,"change","id"],[1,"col","col-1"],[1,"col","col-2"],[1,"col"],[1,"col","col-3"],[1,"btn-entregar",3,"click"]],template:function(i,n){if(i&1){let a=w();f(0,Bi,1,0,"div",1),o(1,"form",2),u("submit",function(){return h(a),b(n.subirProducto())}),o(2,"h2",3),c(3,"A\xF1adir Producto"),r(),F(4,Li,4,3,null,null,Ze),o(6,"div",4)(7,"label",5),c(8," Seleccionar Imagen o arrastra "),r(),o(9,"input",6,0),u("change",function(O){return h(a),b(n.seleccionarImagen(O))}),r()(),f(11,Ni,4,1,"div",7),o(12,"button",8),c(13,"Subir Producto"),r()(),f(14,Wi,1,1,"app-cargando",9),y(15,"async"),f(16,io,8,0,"ul")}i&2&&(p(n.oscurecerPantalla?0:-1),s(4),z(n.campos),s(7),p(n.producto.foto?11:-1),s(3),p(T(15,4,n.cargandoService.cargandoProlongado)?14:-1),s(2),p(n.cargandoService.cargando?-1:16))},dependencies:[D,ne,B,A,ee,me,R,te,k,Ie,H,G,$],styles:["body[_ngcontent-%COMP%]{background-color:#181818;color:var(--text, #fffbe7);font-family:Segoe UI,Roboto,Arial,sans-serif;letter-spacing:.01em}form#uploadForm[_ngcontent-%COMP%]{max-width:600px;margin:24px auto;padding:1.5rem 2rem;border:1px solid var(--border, #444);border-radius:12px;background-color:var(--surface-alt, #23231f);box-shadow:0 2px 12px #7474749c;--color: rgba(197, 197, 197, .123);background-image:linear-gradient(0deg,transparent 24%,var(--color) 25%,var(--color) 26%,transparent 27%,transparent 74%,var(--color) 75%,var(--color) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,var(--color) 25%,var(--color) 26%,transparent 27%,transparent 74%,var(--color) 75%,var(--color) 76%,transparent 77%,transparent);background-size:55px 55px}form#uploadForm[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:var(--text, #fffbe7)}form#uploadForm[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], form#uploadForm[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], form#uploadForm[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.65rem .8rem;margin-bottom:1.1rem;border:1px solid var(--border, #444);border-radius:8px;box-sizing:border-box;background-color:#23231f;color:var(--text, #fffbe7);font-size:1rem;transition:border .18s cubic-bezier(.4,0,.2,1)}form#uploadForm[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus, form#uploadForm[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]:focus, form#uploadForm[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{border-color:var(--primary, #ffd700);outline:none}form#uploadForm[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:none;min-height:80px}form#uploadForm[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{margin-bottom:1rem;background-color:#23231f;color:var(--text, #fffbe7);border:1px solid var(--border, #444);border-radius:8px;padding:.5rem}form#uploadForm[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.6rem 1.2rem;border:none;border-radius:8px;background-color:var(--primary);font-weight:600;font-size:1.05rem;cursor:pointer;box-shadow:0 2px 8px #0002;transition:background .18s cubic-bezier(.4,0,.2,1),color .18s cubic-bezier(.4,0,.2,1)}form#uploadForm[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:var(--primary-dark, #b8860b);color:#fffbe7}.upload-area[_ngcontent-%COMP%]{margin-bottom:1.2rem}.preview-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:110px;object-fit:cover;border:1px solid var(--border, #444);border-radius:8px;margin-top:1rem;box-shadow:0 2px 8px #0002}ul[_ngcontent-%COMP%]{list-style-type:none;padding:0;min-width:800px;width:90%;margin:2rem auto}li.header[_ngcontent-%COMP%]{display:flex;font-weight:700;background-color:var(--bg, #242424);padding:.8rem .5rem;border-bottom:2px solid var(--primary-dark, #b8860b);color:var(--primary, #ffd700);text-transform:uppercase;letter-spacing:1px;border-radius:10px 10px 0 0;box-shadow:0 2px 8px #00000014;margin-bottom:8px;font-size:1.35rem}li.row[_ngcontent-%COMP%]{display:flex;padding:.7rem .5rem;border-bottom:1px solid var(--border, #444);align-items:center;background:var(--surface-alt, #292929);color:var(--text, #fffbe7);border-left:4px solid var(--primary, #ffd700);border-radius:8px;margin-bottom:12px;box-shadow:0 2px 10px #0002;transition:background .18s cubic-bezier(.4,0,.2,1),box-shadow .18s cubic-bezier(.4,0,.2,1),transform .15s cubic-bezier(.4,0,.2,1);font-size:1.1rem}li.row[_ngcontent-%COMP%]:hover{background:#23231f;border-left:4px solid var(--primary-dark, #b8860b);box-shadow:0 4px 18px #0003;transform:scale(1.012)}li[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{padding:0 .7rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.col-1[_ngcontent-%COMP%]{flex-basis:15%;min-width:80px}.col-2[_ngcontent-%COMP%]{flex-basis:30%;min-width:120px}.col-3[_ngcontent-%COMP%], .col-4[_ngcontent-%COMP%]{flex-basis:15%;min-width:80px;text-align:right}.col-5[_ngcontent-%COMP%]{flex-basis:15%;min-width:80px;text-align:center}li.row[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:90px;max-height:90px;object-fit:cover;border:1px solid var(--border, #444);border-radius:6px;box-shadow:0 2px 8px #0002}.triangle[_ngcontent-%COMP%]{display:inline-block;width:0;height:0;border-top:5px solid transparent;border-bottom:5px solid transparent;border-left:8px solid var(--primary, #ffd700);transition:transform .3s}.triangle.down[_ngcontent-%COMP%]{transform:rotate(90deg)}.triangle.left[_ngcontent-%COMP%]{transform:rotate(0)}.reservados-list[_ngcontent-%COMP%]{box-sizing:border-box;margin:0;padding:0 30px;width:100%}@media (max-width: 900px){form#uploadForm[_ngcontent-%COMP%]{padding:1rem .5rem}ul[_ngcontent-%COMP%]{min-width:600px}li.header[_ngcontent-%COMP%], li.row[_ngcontent-%COMP%]{font-size:1rem;padding:.5rem .2rem}.col-1[_ngcontent-%COMP%], .col-2[_ngcontent-%COMP%], .col-3[_ngcontent-%COMP%], .col-4[_ngcontent-%COMP%], .col-5[_ngcontent-%COMP%]{min-width:60px}}@media (max-width: 600px){form#uploadForm[_ngcontent-%COMP%]{padding:.7rem 1rem}ul[_ngcontent-%COMP%]{min-width:400px}h2.titulo[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:.6rem}li[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{padding:.2rem}li.row[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:12vw;max-height:12vw}li.header[_ngcontent-%COMP%], li.row[_ngcontent-%COMP%]{font-size:.8rem;padding:.3rem .1rem}.col-1[_ngcontent-%COMP%]{flex-basis:20%}}"]})}}return t})();var Xe=(t,l)=>{let e=Y(I),i=Y(N);return e.tokenUsuario&&e.tokenUsuario.trim()!==""?i.createUrlTree(["/"]):!0};function oo(t,l){t&1&&(o(0,"p"),c(1,"Verificando tu email..."),r())}function ro(t,l){if(t&1&&(o(0,"p",1),c(1),r(),o(2,"a",2),c(3,"Ir al inicio"),r()),t&2){let e=m();s(),x(e.mensaje)}}function ao(t,l){if(t&1&&(o(0,"p",3),c(1),r(),o(2,"a",2),c(3,"Ir al inicio"),r()),t&2){let e=m();s(),x(e.mensaje)}}var Xt=(()=>{class t{constructor(e,i,n){this.route=e,this.http=i,this.router=n,this.estado="verificando",this.mensaje=""}ngOnInit(){this.route.queryParams.subscribe(e=>{let i=e.token;if(!i){this.estado="error",this.mensaje="Token de verificaci\xF3n no proporcionado.";return}this.http.get(`/usuarios/verificar-email/${i}`).subscribe({next:n=>{this.estado="exito",this.mensaje="\xA1Email verificado correctamente! Ya puedes usar todas las funciones de tu cuenta."},error:n=>{this.estado="error",this.mensaje=n?.error?.error||"Error al verificar el email."}})})}static{this.\u0275fac=function(i){return new(i||t)(g(Me),g(pt),g(N))}}static{this.\u0275cmp=v({type:t,selectors:[["app-verificar-email"]],decls:4,vars:1,consts:[[1,"verificacion-container"],[1,"exito"],["routerLink","/"],[1,"error"]],template:function(i,n){if(i&1&&(o(0,"div",0),f(1,oo,2,0,"p")(2,ro,4,1)(3,ao,4,1),r()),i&2){let a;s(),p((a=n.estado)==="verificando"?1:a==="exito"?2:a==="error"?3:-1)}},styles:[".verificacion-container[_ngcontent-%COMP%]{max-width:400px;margin:3em auto;padding:2em;background:#fff;border-radius:8px;box-shadow:0 2px 8px #00000014;text-align:center}.exito[_ngcontent-%COMP%]{color:#2e7d32;font-weight:700}.error[_ngcontent-%COMP%]{color:#c62828;font-weight:700}"]})}}return t})();var Kt=(()=>{class t{constructor(e,i){this.usuariosService=e,this.toastService=i,this.passwordActual="",this.nuevaPassword="",this.repetirPassword="",this.cambiandoPassword=!1}cambiarPassword(){if(this.nuevaPassword!==this.repetirPassword){this.toastService.error("Las contrase\xF1as nuevas no coinciden.");return}this.cambiandoPassword=!0,this.usuariosService.cambiarPassword({actual:this.passwordActual,nueva:this.nuevaPassword}).subscribe({next:()=>{this.toastService.mostrar("Contrase\xF1a cambiada correctamente."),this.passwordActual="",this.nuevaPassword="",this.repetirPassword="",this.cambiandoPassword=!1},error:e=>{this.toastService.error(e),this.cambiandoPassword=!1}})}onPasswordGenerada(e){this.repetirPassword=e}static{this.\u0275fac=function(i){return new(i||t)(g(W),g(q))}}static{this.\u0275cmp=v({type:t,selectors:[["app-cambiar-password"]],decls:10,vars:10,consts:[["form","ngForm"],[1,"cambiar-password-container"],["autocomplete","off",3,"ngSubmit"],["label","Contrase\xF1a actual",3,"valueChange","value","required"],["label","Nueva contrase\xF1a",3,"valueChange","passwordGenerada","value","showStrength","showGenerator","mostrarRequisitos","required"],["label","Repetir contrase\xF1a",3,"valueChange","value","required"],["type","submit",3,"disabled"]],template:function(i,n){if(i&1){let a=w();o(0,"div",1)(1,"h2"),c(2,"Cambiar contrase\xF1a"),r(),o(3,"form",2,0),u("ngSubmit",function(){return h(a),b(n.cambiarPassword())}),o(5,"app-password-field",3),S("valueChange",function(O){return h(a),P(n.passwordActual,O)||(n.passwordActual=O),b(O)}),r(),o(6,"app-password-field",4),S("valueChange",function(O){return h(a),P(n.nuevaPassword,O)||(n.nuevaPassword=O),b(O)}),u("passwordGenerada",function(O){return h(a),b(n.onPasswordGenerada(O))}),r(),o(7,"app-password-field",5),S("valueChange",function(O){return h(a),P(n.repetirPassword,O)||(n.repetirPassword=O),b(O)}),r(),o(8,"button",6),c(9," Cambiar contrase\xF1a "),r()()()}i&2&&(s(5),M("value",n.passwordActual),_("required",!0),s(),M("value",n.nuevaPassword),_("showStrength",!0)("showGenerator",!0)("mostrarRequisitos",!0)("required",!0),s(),M("value",n.repetirPassword),_("required",!0),s(),_("disabled",n.cambiandoPassword||!n.passwordActual||n.nuevaPassword.length<6||n.repetirPassword.length<6))},dependencies:[D,ne,ee,te,We],styles:[".cambiar-password-container[_ngcontent-%COMP%]{max-width:400px;margin:40px auto;padding:2rem 2.5rem;background:#23272f;border-radius:12px;box-shadow:0 2px 16px #00000040;position:relative}.cambiar-password-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem;color:#fff}.form-group[_ngcontent-%COMP%]{margin-bottom:1.2rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.4rem;color:#bfc7d5;font-weight:500}.form-group[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%;padding:.6rem;border:1px solid #444a57;border-radius:6px;font-size:1rem;background:#181b20;color:#fff;transition:border .2s,background .2s}.form-group[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;background:#23272f}.input-con-visualizador[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#7a8599;opacity:1}.mensaje-password[_ngcontent-%COMP%]{margin-bottom:1rem;color:#ff6b6b;text-align:center;font-size:.98rem}button[type=submit][_ngcontent-%COMP%]{width:100%;padding:.7rem;background:linear-gradient(90deg,#007bff 60%,#0056b3);color:#fff;border:none;border-radius:6px;font-size:1.1rem;font-weight:600;cursor:pointer;transition:background .2s;margin-top:.5rem}button[type=submit][_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(90deg,#0056b3 60%,#007bff)}button[disabled][_ngcontent-%COMP%]{opacity:.7;cursor:not-allowed}.input-con-visualizador[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-con-visualizador[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding-right:2.5rem}.icono-visualizar[_ngcontent-%COMP%]{position:absolute;right:.7rem;top:50%;transform:translateY(-50%);cursor:pointer;display:flex;align-items:center;height:100%;color:#fff;background:transparent;border:none;padding:0;z-index:2}.icono-visualizar[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{display:block;pointer-events:none;stroke:#fff}.password-strength-bar[_ngcontent-%COMP%]{margin-top:.4rem;height:1.2rem;border-radius:6px;display:flex;align-items:center;font-size:.95rem;font-weight:500;padding-left:.7rem;background:#23272f;color:#fff;border:1px solid #444a57;transition:background .2s,color .2s}.password-strength-bar.debil[_ngcontent-%COMP%]{background:#3a2323;color:#ff6b6b;border-color:#ff6b6b44}.password-strength-bar.media[_ngcontent-%COMP%]{background:#2e2e1e;color:#ffd166;border-color:#ffd16644}.password-strength-bar.fuerte[_ngcontent-%COMP%]{background:#1e322e;color:#06d6a0;border-color:#06d6a044}.password-requisitos[_ngcontent-%COMP%]{list-style:none;padding:0 0 0 .2rem;margin:.3rem 0 .2rem}.password-requisitos[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center;color:#bfc7d5;font-size:.97rem;margin-bottom:.1rem;gap:.5rem;transition:color .2s}.password-requisitos[_ngcontent-%COMP%]   li.cumplido[_ngcontent-%COMP%]{color:#06d6a0;font-weight:600}.icono-requisito[_ngcontent-%COMP%]{font-size:1.1em;width:1.5em;display:inline-flex;align-items:center;justify-content:center}.coincidencia-password[_ngcontent-%COMP%]{margin-left:.7rem;font-size:.98rem;font-weight:500;display:inline-flex;align-items:center;gap:.3em}.coincide[_ngcontent-%COMP%]{color:#06d6a0}.no-coincide[_ngcontent-%COMP%]{color:#ff6b6b}.btn-generar[_ngcontent-%COMP%]{margin-left:.7rem;padding:.4rem .8rem;background:linear-gradient(90deg,#23272f 60%,#181b20);color:#fff;border:1px solid #444a57;border-radius:6px;font-size:.97rem;font-weight:500;cursor:pointer;display:flex;align-items:center;gap:.2em;transition:background .2s,border .2s;box-shadow:none}.btn-generar[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(90deg,#181b20 60%,#23272f);border-color:#007bff}.btn-generar[disabled][_ngcontent-%COMP%]{opacity:.7;cursor:not-allowed}.btn-generar-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:.5rem}"]})}}return t})();function so(t,l){t&1&&(o(0,"p"),c(1," Tu cuenta ha sido eliminada correctamente."),C(2,"br"),c(3," Sentimos verte partir. \xA1Gracias por haber confiado en Fadey! "),r())}function co(t,l){t&1&&(o(0,"p",2),c(1," El enlace de confirmaci\xF3n no es v\xE1lido o ha expirado."),C(2,"br"),c(3," Si necesitas ayuda, contacta con soporte. "),r())}var en=(()=>{class t{constructor(e,i,n){this.route=e,this.httpService=i,this.datosService=n,this.estado="",this.token="",this.route.queryParams.subscribe(a=>{this.token=a.token||"",this.confirmarEliminacion()})}confirmarEliminacion(){if(!this.token){this.estado="error";return}this.httpService.post("/usuarios/confirmar-eliminacion",{token:this.token}).subscribe({next:()=>{this.estado="ok",this.datosService.limpiarUser()},error:()=>{this.estado="error"}})}static{this.\u0275fac=function(i){return new(i||t)(g(Me),g(K),g(I))}}static{this.\u0275cmp=v({type:t,selectors:[["app-confirmar-eliminacion"]],decls:6,vars:1,consts:[[1,"confirmar-eliminacion-container"],[1,"confirmar-eliminacion-card"],[2,"color","#ff5252"]],template:function(i,n){i&1&&(o(0,"section",0)(1,"div",1)(2,"h1"),c(3,"Eliminar cuenta"),r(),f(4,so,4,0,"p")(5,co,4,0,"p",2),r()()),i&2&&(s(4),p(n.estado==="ok"?4:n.estado==="error"?5:-1))},dependencies:[k],styles:[".confirmar-eliminacion-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:#181c23}.confirmar-eliminacion-card[_ngcontent-%COMP%]{background:#23272f;color:#eaf0fa;border-radius:14px;padding:2.5em 2em 2em;box-shadow:0 8px 32px #00000040;max-width:400px;width:90vw;text-align:center}.confirmar-eliminacion-card[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#ff5252;font-size:2em;margin-bottom:.7em;font-weight:700;letter-spacing:.5px;text-shadow:0 2px 12px rgba(220,0,0,.18)}.confirmar-eliminacion-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#b3b3b3;font-size:1.1em;margin-bottom:2em}.btn-eliminar[_ngcontent-%COMP%]{background:#d32f2f;color:#fff;border:none;border-radius:6px;padding:.7em 1.5em;font-weight:700;cursor:pointer;margin-right:1em;transition:background .2s}.btn-eliminar[_ngcontent-%COMP%]:hover{background:#b71c1c}.btn-cancelar[_ngcontent-%COMP%]{background:#444;color:#fff;border:none;border-radius:6px;padding:.7em 1.5em;font-weight:700;cursor:pointer;transition:background .2s}.btn-cancelar[_ngcontent-%COMP%]:hover{background:#222}.mensaje-eliminacion[_ngcontent-%COMP%]{margin-top:1.5em;color:#d32f2f;font-weight:500}"]})}}return t})();var tn=[{path:"registro",component:Ft},{path:"inicio-sesion",component:zt,canActivate:[Xe]},{path:"crear-citas",component:It,canActivate:[Z]},{path:"mis-citas",component:Bt,canActivate:[Z]},{path:"mis-productos",component:Zt,canActivate:[Z]},{path:"solicitudes",component:Rt,canActivate:[Z]},{path:"relaciones",component:Lt,canActivate:[Z]},{path:"chats",component:Nt,canActivate:[Z]},{path:"editar-perfil",component:qt,canActivate:[Z]},{path:"verificar-email",component:Xt},{path:"cambiar-password",component:Kt,canActivate:[Z]},{path:"recuperar-password",loadComponent:()=>import("./chunk-QHGVLP3X.js").then(t=>t.RecuperarPasswordComponent),canActivate:[Xe]},{path:"restablecer-password/:token",loadComponent:()=>import("./chunk-QDCPAD5J.js").then(t=>t.RestablecerPasswordComponent)},{path:"confirmar-eliminacion",component:en},{path:":username",canActivate:[$t,Z],children:[{path:"mensajes",component:Et},{path:"citas",component:xt},{path:"productos",component:Tt},{path:"",component:Gt}]},{path:"",component:Jt,pathMatch:"full",canActivate:[Z]},{path:"**",redirectTo:"/"}];var nn=(t,l)=>{let e=Y(V);return parseInt(t.headers.get("SaltarCargando")||"0")||(e.cargando=!0),t.headers.delete("SaltarCargando"),l(t)};var on=(t,l)=>{let e=t.clone({url:`${Pe.serverUrl}${t.url}`});return l(e)};var rn={providers:[lt({eventCoalescing:!0}),Ct(tn),ut(gt([nn,on])),nt(yt.forRoot({url:`${Pe.serverUrl}`,options:{}}))]};function lo(t,l){if(t&1){let e=w();o(0,"li",7),u("click",function(){let n=h(e).$implicit,a=m(2);return b(a.buscadorService.seleccionarUsuario(n.username))}),C(1,"img",8),y(2,"uploads"),o(3,"span"),c(4),r()()}if(t&2){let e=l.$implicit,i=m(2);s(),_("src",T(2,2,e.foto_perfil)||i.datosService.noFoto,L),s(3),x(e.username)}}function mo(t,l){if(t&1&&(o(0,"ul",5),f(1,lo,5,4,"li",6),r()),t&2){let e=m();s(),_("ngForOf",e.buscadorService.resultados)}}var Ke=(()=>{class t{constructor(e,i){this.buscadorService=e,this.datosService=i,this.mostrarResultados=!1}cerrarMenu(e){let i=e.target,n=document.querySelector(".form-control");n&&!n.contains(i)&&(this.mostrarResultados=!1)}static{this.\u0275fac=function(i){return new(i||t)(g(He),g(I))}}static{this.\u0275cmp=v({type:t,selectors:[["app-buscador"]],hostBindings:function(i,n){i&1&&u("click",function(d){return n.cerrarMenu(d)},!1,Ce)},decls:6,vars:2,consts:[["userInput",""],[1,"form-control"],["type","text","placeholder","Buscar usuarios...",1,"input","input-alt",3,"input","keydown.enter","focus","ngModelChange","ngModel"],[1,"input-border"],[1,"input-border-alt"],[1,"autocomplete-list"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["alt","Avatar",1,"avatar",3,"src"]],template:function(i,n){if(i&1){let a=w();o(0,"div",1)(1,"input",2,0),u("input",function(){return h(a),b(n.buscadorService.buscarUsuarios())})("keydown.enter",function(){return h(a),b(n.buscadorService.seleccionarPrimero())})("focus",function(){return h(a),b(n.mostrarResultados=!0)}),S("ngModelChange",function(O){return h(a),P(n.buscadorService.buscador,O)||(n.buscadorService.buscador=O),b(O)}),r(),o(3,"div",3),C(4,"div",4),r(),f(5,mo,2,1,"ul",5),r()}i&2&&(s(),M("ngModel",n.buscadorService.buscador),s(4),p(n.buscadorService.resultados.length>0&&n.mostrarResultados?5:-1))},dependencies:[k,Ve,D,B,A,R,G],styles:[".form-control[_ngcontent-%COMP%]{position:relative}.input[_ngcontent-%COMP%]{color:#fff;font-size:.8vw;background-color:transparent;box-sizing:border-box;border-radius:.6em;padding-inline:.5em;padding-block:.7em;border:none;margin-left:.15vw;width:14vw}.input[_ngcontent-%COMP%]:hover{box-shadow:0 0 0 .1vw #87cfeb2f}.input[_ngcontent-%COMP%]:hover + .input[_ngcontent-%COMP%]:focus{box-shadow:0 0}.input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0}.input-border[_ngcontent-%COMP%]{position:absolute;width:0%;height:2px;bottom:0;left:0;transition:width .6s cubic-bezier(.6,.5,.735,.45)}.input-border-alt[_ngcontent-%COMP%]{margin:0 .3vw;height:3px;border-radius:1em;background:linear-gradient(90deg,red,#fff 45% 55%,#2212ff)}.input-alt[_ngcontent-%COMP%]:focus + .input-border-alt[_ngcontent-%COMP%]{width:100%}.input[_ngcontent-%COMP%]:focus + .input-border[_ngcontent-%COMP%]{width:100%}.autocomplete-list[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0;border:none;background:#23243a;box-shadow:0 4px 24px #4c3fff21;border-radius:0 0 .7em .7em;position:absolute;z-index:1000;width:100%;overflow:hidden}.autocomplete-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:1vw;cursor:pointer;display:flex;align-items:center;gap:.7em;background:none;color:#fff;font-size:1vw;transition:background .18s,color .18s,box-shadow .18s;border-bottom:1px solid rgba(255,255,255,.07);position:relative}.autocomplete-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}.autocomplete-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover, .autocomplete-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:focus{background:linear-gradient(90deg,#35355a,#23243a);color:#6c63ff;box-shadow:0 2px 12px #4c3fff1a;outline:none}.autocomplete-list[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:2.1em;height:2.1em;border-radius:50%;margin-right:.7em;border:2px solid #35355a;object-fit:cover;background:#18192b}@media (max-width: 600px){.form-control[_ngcontent-%COMP%]{width:100%}.input[_ngcontent-%COMP%]{font-size:.8rem;padding-inline:.4em;padding-block:.6em;width:30vw}.autocomplete-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.8rem}.avatar[_ngcontent-%COMP%]{width:25px;height:25px}}"]})}}return t})();var an=(()=>{class t{constructor(e,i,n){this.httpService=e,this.socket=i,this.toastService=n,this.notificaciones=[]}obtenerNotificaciones(){return this.httpService.getToken("/notificaciones",void 0,!0)}marcarTodasLeidas(){this.httpService.putToken("/notificaciones/leidas",void 0,!0).subscribe({next:()=>{this.notificaciones.forEach(e=>e.leida=!0)},error:e=>{this.toastService.error(e)}})}conectar(e){this.socket.emit("registro",e)}recibirNotificacion(){return this.socket.fromEvent("nuevaNotificacion")}static{this.\u0275fac=function(i){return new(i||t)(se(K),se(Ot),se(q))}}static{this.\u0275prov=_e({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var uo=t=>({"fade-out":t});function go(t,l){t&1&&C(0,"span",2)}function fo(t,l){t&1&&C(0,"span",7)}function _o(t,l){if(t&1&&(o(0,"li"),f(1,fo,1,0,"span",7),c(2),r()),t&2){let e=l.$implicit,i=m(2);s(),p(e.leida?-1:1),s(),E(" ",i.crearMensaje(e)," ")}}function Co(t,l){t&1&&(o(0,"li"),c(1," No tienes notificaciones. "),r())}function ho(t,l){t&1&&(o(0,"li"),c(1," Cargando notificaciones... "),r())}function bo(t,l){if(t&1&&(o(0,"div",6)(1,"h3"),c(2,"Notificaciones"),r(),o(3,"ul"),F(4,_o,3,2,"li",null,he),f(6,Co,2,0,"li")(7,ho,2,0,"li"),r()()),t&2){let e=m();_("ngClass",X(3,uo,e.fadeOut)),s(4),z(e.notificacionesService.notificaciones),s(2),p(e.notificacionesService.notificaciones.length===0&&e.notificacionesCargadas?6:-1),s(),p(e.notificacionesCargadas?-1:7)}}var sn=(()=>{class t{constructor(e,i,n){this.notificacionesService=e,this.elementRef=i,this.toastService=n,this.notificacionesAbierto=!1,this.fadeOut=!1,this.notificacionesCargadas=!1}ngOnInit(){let e=parseInt(JSON.parse(localStorage.getItem("user")||"{}").id||"0",10);this.notificacionesService.conectar(e),this.notificacionesService.recibirNotificacion().subscribe(i=>{this.notificacionesService.notificaciones.unshift(i)})}onDocumentClick(e){this.notificacionesAbierto&&!this.elementRef.nativeElement.contains(e.target)&&this.alternarNotificaciones()}alternarNotificaciones(){!this.notificacionesAbierto&&!this.notificacionesCargadas&&this.notificacionesService.obtenerNotificaciones().subscribe({next:e=>{this.notificacionesService.notificaciones=e},error:e=>{this.toastService.error(e)},complete:()=>{this.notificacionesCargadas=!0}}),this.notificacionesAbierto?(this.fadeOut=!0,setTimeout(()=>{this.notificacionesAbierto=!1,this.fadeOut=!1},200),this.todasLeidas()||this.notificacionesService.marcarTodasLeidas()):this.notificacionesAbierto=!0}crearMensaje(e){let i="";switch(e.tipo){case"mensaje":i=`Nuevo mensaje de ${e.username}`;break;case"cita":let n=new Date(e.mensaje);i=`Nueva cita de ${e.username} para ${n.toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"})} a las ${n.toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"})}`;break;case"producto":let a=JSON.parse(e.mensaje);i=`${e.username} ha reservado ${a.cantidad} ${a.producto}`;break;case"solicitud":i=`${e.username} te ha enviado una solicitud`;break;case"relacion":i=`${e.username} ha ${e.mensaje} tu solicitud`;break;default:i=`Notificaci\xF3n de ${e.username}`}return i}todasLeidas(){return this.notificacionesService.notificaciones.every(e=>e.leida==!0)}static{this.\u0275fac=function(i){return new(i||t)(g(an),g(ot),g(q))}}static{this.\u0275cmp=v({type:t,selectors:[["app-notificaciones"]],hostBindings:function(i,n){i&1&&u("click",function(d){return n.onDocumentClick(d)},!1,Ce)},decls:7,vars:2,consts:[[1,"notificaciones"],["id","boton-notificaciones",3,"click"],[1,"notificaciones-pendientes"],["width","24","height","24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"feather","feather-bell"],["d","M18 8a6 6 0 0 0-12 0c0 7-3 9-3 9h18s-3-2-3-9"],["d","M13.73 21a2 2 0 0 1-3.46 0"],[1,"notificaciones-dropdown",3,"ngClass"],[1,"punto-verde"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"button",1),u("click",function(){return n.alternarNotificaciones()}),f(2,go,1,0,"span",2),Q(),o(3,"svg",3),C(4,"path",4)(5,"path",5),r()(),f(6,bo,8,5,"div",6),r()),i&2&&(s(2),p(n.todasLeidas()?-1:2),s(4),p(n.notificacionesAbierto?6:-1))},dependencies:[k,Ie],styles:[".notificaciones[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;cursor:pointer}h3[_ngcontent-%COMP%]{margin:0}#boton-notificaciones[_ngcontent-%COMP%]{background:none;color:#fff;border:none;padding:.5rem 1rem;cursor:pointer}#boton-notificaciones[_ngcontent-%COMP%]:hover{background:#23234a;border-radius:8px}#boton-notificaciones[_ngcontent-%COMP%]:focus{outline:none}#boton-notificaciones[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{stroke:#fff;width:1.5rem;height:1.5rem}.notificaciones-dropdown[_ngcontent-%COMP%]{position:absolute;top:60px;background:#181828;color:#fff;min-width:260px;border-radius:12px;box-shadow:0 8px 32px #00000040;z-index:100;padding:.5rem 0;font-size:1rem;animation:_ngcontent-%COMP%_fadeIn .2s}.notificaciones-dropdown[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;max-height:30vh;overflow-y:auto;margin:0;padding:0}.notificaciones-dropdown[_ngcontent-%COMP%]   li[_ngcontent-%COMP%], .notificaciones-dropdown[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{padding:.75rem 1.2rem;border-bottom:1px solid #23234a;transition:background .2s;cursor:default;word-break:break-word}.notificaciones-dropdown[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child{border-bottom:none}.notificaciones-dropdown[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background:#23234a}.notificaciones-dropdown[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:empty{display:none}.notificaciones-dropdown.fade-out[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeOut .2s forwards}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeOut{0%{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-10px)}}.punto-verde[_ngcontent-%COMP%]{display:inline-block;width:10px;height:10px;background:#22c55e;border-radius:50%;margin-right:8px;vertical-align:middle}.notificaciones-pendientes[_ngcontent-%COMP%]{display:inline-block;position:absolute;right:10px;width:10px;height:10px;background:linear-gradient(#d0ff00,#53f78f);border-radius:50%;vertical-align:middle}@media (max-width: 600px){.notificaciones-dropdown[_ngcontent-%COMP%]{min-width:100px;width:60vw;right:-20px}}"]})}}return t})();var xo=["menu"],vo=["burguer"];function wo(t,l){t&1&&C(0,"img",8)}function Mo(t,l){t&1&&C(0,"img",9)}function Po(t,l){t&1&&(o(0,"a",12),c(1,"Productos"),r())}function So(t,l){t&1&&(o(0,"a",14),c(1,"Solicitudes"),r())}function Oo(t,l){if(t&1){let e=w();o(0,"div",3,0)(2,"button",7),u("click",function(){h(e);let n=m();return b(n.burguerAbierto=!n.burguerAbierto)}),f(3,wo,1,0,"img",8)(4,Mo,1,0,"img",9),r(),o(5,"nav")(6,"a",10),c(7,"Crear"),r(),o(8,"a",11),c(9,"Citas"),r(),f(10,Po,2,0,"a",12),o(11,"a",13),c(12,"Relaciones"),r(),f(13,So,2,0,"a",14),o(14,"a",15),c(15,"Chats"),r()()()}if(t&2){let e=m();s(3),p(e.burguerAbierto?4:3),s(2),ce("abierto",e.burguerAbierto),s(5),p(e.datosService.esBarbero()?10:-1),s(3),p(e.datosService.esBarbero()?13:-1)}}function yo(t,l){t&1&&C(0,"app-buscador",16)}function ko(t,l){t&1&&(o(0,"div",17),C(1,"div",23),o(2,"a",24),c(3,"Crear"),r()())}function Eo(t,l){if(t&1&&c(0),t&2){let e=m(2);E(" ",e.datosService.user.username.charAt(0).toUpperCase()," ")}}function To(t,l){if(t&1&&(C(0,"img",21),y(1,"uploads")),t&2){let e=m(2);_("src",T(1,1,e.datosService.user.foto_perfil),L)}}function jo(t,l){if(t&1){let e=w();o(0,"ul",22,1)(2,"li",25),Q(),o(3,"svg",26),C(4,"path",27)(5,"path",28),r(),c(6," Perfil "),r(),ue(),o(7,"li",29),u("click",function(){h(e);let n=m(2);return b(n.logout())}),Q(),o(8,"svg",30),C(9,"path",31),r(),c(10," Cerrar Sesi\xF3n "),r()()}}function Fo(t,l){if(t&1){let e=w();o(0,"div",4),f(1,yo,1,0,"app-buscador",16),C(2,"app-notificaciones"),f(3,ko,4,0,"div",17),o(4,"div",18),u("click",function(){h(e);let n=m();return b(n.alternarMenu())}),o(5,"div",19),c(6),r(),o(7,"span",20),f(8,Eo,1,1)(9,To,2,3,"img",21),r(),f(10,jo,11,0,"ul",22),r()()}if(t&2){let e=m();s(),p(e.paginaPrincipal()?-1:1),s(2),p(e.datosService.esBarbero()?3:-1),s(3),x(e.datosService.user.username),s(2),p(e.datosService.user.foto_perfil?9:8),s(2),p(e.menuAbierto?10:-1)}}var cn=(()=>{class t{constructor(e,i,n,a){this.datosService=e,this.router=i,this.httpService=n,this.toastService=a,this.menuAbierto=!1,this.burguerAbierto=!1}ngOnInit(){this.datosService.tokenUsuario=localStorage.getItem("token")||"",this.datosService.user=JSON.parse(localStorage.getItem("user")||"{}"),this.datosService.tokenUsuario&&this.httpService.getToken("/usuarios").subscribe({next:e=>{this.datosService.user=e,localStorage.setItem("user",JSON.stringify(e))},error:e=>{this.toastService.error(e),this.router.navigate(["/inicio-sesion"])}})}paginaPrincipal(){return this.router.url=="/"}logout(){localStorage.clear(),this.datosService.tokenUsuario="",this.datosService.limpiarUser(),this.router.navigate(["/inicio-sesion"])}alternarMenu(){this.menuAbierto=!this.menuAbierto}onDocumentClick(e){this.menuAbierto&&this.menuRef&&!this.menuRef.nativeElement.contains(e.target)&&(this.menuAbierto=!1),this.burguerAbierto&&this.burguerRef&&!this.burguerRef.nativeElement.contains(e.target)&&(this.burguerAbierto=!1)}static{this.\u0275fac=function(i){return new(i||t)(g(I),g(N),g(K),g(q))}}static{this.\u0275cmp=v({type:t,selectors:[["app-root"]],viewQuery:function(i,n){if(i&1&&(be(Ke,5),be(xo,5),be(vo,5)),i&2){let a;xe(a=ve())&&(n.buscadorComponent=a.first),xe(a=ve())&&(n.menuRef=a.first),xe(a=ve())&&(n.burguerRef=a.first)}},hostBindings:function(i,n){i&1&&u("click",function(d){return n.onDocumentClick(d)},!1,Ce)},decls:10,vars:2,consts:[["burguer",""],["menu",""],["routerLink","/",1,"titulo-container"],[1,"nav-burguer-container"],[1,"header-usuario"],[1,"container"],[1,"app"],["aria-label","Abrir men\xFA de navegaci\xF3n",1,"burguer",3,"click"],["src","svgs/icono-menu.svg","width","24","height","24","alt","Abrir men\xFA"],["src","svgs/icono-cerrar-menu.svg","width","24","height","24","alt","Cerrar men\xFA"],["id","crear-citas","routerLink","crear-citas","routerLinkActive","active-link"],["routerLink","mis-citas","routerLinkActive","active-link"],["routerLink","mis-productos","routerLinkActive","active-link"],["routerLink","relaciones","routerLinkActive","active-link"],["routerLink","solicitudes","routerLinkActive","active-link"],["routerLink","chats","routerLinkActive","active-link"],["id","buscador"],[1,"crear-citas"],[1,"user",3,"click"],[1,"username"],[1,"marco-perfil"],["alt","Foto de perfil",1,"foto-perfil",3,"src"],[1,"dropdown-menu"],["id","sombra-crear-citas"],["routerLink","/crear-citas","id","boton-crear-citas"],["routerLink","editar-perfil"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","width","24","height","24",1,"mr-2","w-5","h-5"],["fill","none","d","M0 0h24v24H0z"],["fill","currentColor","d","M20 22h-2v-2a3 3 0 0 0-3-3H9a3 3 0 0 0-3 3v2H4v-2a5 5 0 0 1 5-5h6a5 5 0 0 1 5 5v2zm-8-9a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"],[3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2",1,"mr-2","w-5","h-5"],["d","M18.189 9a15 15 0 0 1 2.654 2.556c.105.13.157.287.157.444m-2.811 3a14.998 14.998 0 0 0 2.654-2.556A.704.704 0 0 0 21 12m0 0H8m5-7.472A6 6 0 0 0 3 9v6a6 6 0 0 0 10 4.472"]],template:function(i,n){i&1&&(o(0,"header")(1,"div",2)(2,"p"),c(3,"Fadey"),r()(),f(4,Oo,16,5,"div",3)(5,Fo,11,5,"div",4),r(),o(6,"div",5)(7,"div",6),C(8,"router-outlet"),r()(),C(9,"app-toast")),i&2&&(s(4),p(n.datosService.tokenUsuario?4:-1),s(),p(n.datosService.user.username?5:-1))},dependencies:[ft,U,_t,Ke,sn,k,G,Ne],styles:['header[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:.6rem 1.4rem}.titulo-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:2.5em;cursor:pointer;font-weight:700;margin:0;background:repeating-linear-gradient(-45deg,red,red 15px,#fff 20px 35px,#2212ff 40px 55px,#fff 60px 75px);background-size:800% 800%;animation:_ngcontent-%COMP%_gradient 45s ease-in-out infinite;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;transform:rotateX(15deg) rotateY(-20deg)}@keyframes _ngcontent-%COMP%_gradient{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.header[_ngcontent-%COMP%]{margin-left:auto;display:flex;align-items:center;gap:1.5em;position:relative}.header[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{font-weight:600}.user[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5em;cursor:pointer}.username[_ngcontent-%COMP%]{font-size:1vw}.marco-perfil[_ngcontent-%COMP%]{display:inline-block;width:2rem;height:2rem;background-color:#6068d4;border-radius:10%;display:flex;justify-content:center;align-items:center;font-weight:700;font-size:1.2em;padding:0}.foto-perfil[_ngcontent-%COMP%]{object-fit:cover;width:2rem;height:2rem}nav[_ngcontent-%COMP%]{display:flex;margin-left:2em;gap:2em}nav[_ngcontent-%COMP%]   a#crear-citas[_ngcontent-%COMP%]{display:none}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{border:0;width:100%;text-decoration:none;color:#fff;padding:6px 10px;border-radius:5px 5px 0 0;margin-bottom:5px;position:relative;font-size:1vw}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#242424}nav[_ngcontent-%COMP%]   a.active-link[_ngcontent-%COMP%]{background:linear-gradient(0deg,#433dc5,#0e0c27);background-size:100% 200%;background-position:0% 0%;animation:_ngcontent-%COMP%_active-link-bg-up .7s forwards}@keyframes _ngcontent-%COMP%_active-link-bg-up{0%{background-position:0% 50%}to{background-position:0% 100%}}nav[_ngcontent-%COMP%]   a.active-link[_ngcontent-%COMP%]:after{transform:scaleX(1)}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;width:100%;transform:scaleX(0);height:2px;bottom:0;left:0;background-color:#fff;transform-origin:bottom right;transition:transform .25s ease-out}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{transform:scaleX(1);transform-origin:bottom left}.container[_ngcontent-%COMP%]{display:flex;width:100%}.app[_ngcontent-%COMP%]{width:100%;justify-content:center}.dropdown-menu[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0;border:.2rem solid #292929;position:absolute;z-index:1000;top:100%;margin-top:.4rem;right:0;border-radius:.6rem}.dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px;cursor:pointer;display:flex;align-items:center}.dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#313131}.dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#fff;display:block}.dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-right:10px;width:1.5rem;height:1.5rem}.dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;background:none;padding:0}.dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}.crear-citas[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center}.crear-citas[_ngcontent-%COMP%]:hover   #sombra-crear-citas[_ngcontent-%COMP%]{transform:translate(-50%,-7rem) scale(1.2);transition:transform .6s}#sombra-crear-citas[_ngcontent-%COMP%]{position:absolute;left:50%;top:0;transform:translate(-50%,-7rem);width:200%;height:80px;border-radius:9999px;background:linear-gradient(135deg,#6366f1,#fff);filter:blur(32px);z-index:0;transition:transform .6s}#boton-crear-citas[_ngcontent-%COMP%]{background:linear-gradient(120deg,#ccc,#483bff);color:#fff;border:none;padding:.5rem 1.2rem;border-radius:.4rem;font-weight:700;cursor:pointer;font-size:1vw;width:4vw;max-width:200px;text-align:center;transition:background .2s,color .2s,box-shadow .2s}#boton-crear-citas[_ngcontent-%COMP%]:hover{background-color:#313131}#boton-crear-citas[_ngcontent-%COMP%]:focus{outline:none}.nav-burguer-container[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative;width:100%}.burguer[_ngcontent-%COMP%]{display:none;justify-content:center;align-items:center;width:38px;height:38px;background:none;border:none;cursor:pointer;z-index:1200;margin:auto;padding:0}.burguer[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:28px;height:28px;display:block}.header-usuario[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:1.5em;position:relative}.header-usuario[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{font-weight:600}@media (max-width: 600px){.username[_ngcontent-%COMP%]{display:none}.nav-burguer-container[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]{display:none;position:absolute;top:48px;left:0;right:0;background:#232323;flex-direction:column;gap:.5em;z-index:1100;border-radius:10px;box-shadow:0 4px 24px #0005;animation:_ngcontent-%COMP%_fadeInNav .2s;box-sizing:border-box}.nav-burguer-container[_ngcontent-%COMP%]   nav.abierto[_ngcontent-%COMP%]{display:flex;width:30vw;margin:0 auto}.burguer[_ngcontent-%COMP%]{display:flex}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{width:100%;text-align:left;font-size:1.1em;padding:10px 12px;border-radius:6px;margin-bottom:0}header[_ngcontent-%COMP%]{flex-direction:row;align-items:center;justify-content:space-between;padding:.5rem}.titulo-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:2em;text-align:left;margin-bottom:.5em}.header[_ngcontent-%COMP%]{flex-direction:column;gap:.7em;margin-left:0;width:100%}.user[_ngcontent-%COMP%]{gap:.7em;font-size:.95em}nav[_ngcontent-%COMP%]{flex-direction:column;gap:.5em;margin-left:0;width:100%}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{border-radius:5px;padding:8px 10px;font-size:1em;width:100%;margin-bottom:0;box-sizing:border-box}nav[_ngcontent-%COMP%]   a#crear-citas[_ngcontent-%COMP%]{display:block}.container[_ngcontent-%COMP%]{flex-direction:column;width:100vw;padding:0}.app[_ngcontent-%COMP%]{width:100vw;box-sizing:border-box;padding:0 4vw}.dropdown-menu[_ngcontent-%COMP%]{background:#181828;right:0;min-width:160px;border-radius:0 0 .6rem .6rem}.dropdown-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:12px 8px;font-size:1em}#buscador[_ngcontent-%COMP%]{margin-right:0}.marco-perfil[_ngcontent-%COMP%], .foto-perfil[_ngcontent-%COMP%]{width:2rem;height:2rem;font-size:1em}.crear-citas[_ngcontent-%COMP%]{justify-content:flex-start;padding-left:.5em}div.crear-citas[_ngcontent-%COMP%]{display:none}#sombra-crear-citas[_ngcontent-%COMP%]{width:120vw;left:50%;top:0;height:60px;filter:blur(18px)}.header-usuario[_ngcontent-%COMP%]{gap:.7em;margin-left:0}}@keyframes _ngcontent-%COMP%_fadeInNav{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}']})}}return t})();mt(cn,rn).catch(t=>console.error(t));
